{"version":3,"file":"gakkai-shift.js","sources":["../../gakkai-shift-model/dist/lib/master/TimeSlot_時間帯.js","../../gakkai-shift-model/dist/lib/master/Role_係.js","../../gakkai-shift-model/dist/lib/staff/Staff_スタッフ.js","../../gakkai-shift-model/dist/lib/shift-plan/ShiftAssignment_シフト配置.js","../../gakkai-shift-model/dist/lib/shift-plan/SlotRoleEvaluation_配置枠評価.js","../../gakkai-shift-model/dist/lib/shift-plan/ShiftPlan_シフト案.js","../../gakkai-shift-model/dist/lib/shift-plan/StaffAssignmentEvaluation_スタッフ配置評価.js","../../gakkai-shift-model/dist/lib/shift-plan/ShiftMatcher_シフトマッチング.js","../src/slice/shift-plan-slice.ts","../src/slice/gakkai-shift-slice.ts","../src/ui/StaffListView.tsx","../src/data/sampleStaff.ts","../src/feature/StaffCollection.tsx","../src/feature/StaffFilter.tsx","../src/ui/StaffDetailView.tsx","../src/feature/StaffDetail.tsx","../src/ui/StaffAvailabilityView.tsx","../src/feature/StaffAvailability.tsx","../src/ui/ShiftPlanTableView.tsx","../src/feature/ShiftPlanEditor.tsx","../src/feature/ShiftPlanManager.tsx","../src/ui/AssignmentEvaluationView.tsx","../src/feature/AssignmentEvaluation.tsx","../src/ui/StaffShiftTableView.tsx","../src/feature/StaffShiftTable.tsx","../src/registration/bubbleRoutes.tsx","../src/bubly.ts"],"sourcesContent":["/**\n * 時間帯ドメインモデル\n * StaffRequirement（必要人数）を集約として含む\n */\n// ========== 必要人数クラス ==========\nexport class StaffRequirement_必要人数 {\n    state;\n    timeSlotId;\n    constructor(state, timeSlotId) {\n        this.state = state;\n        this.timeSlotId = timeSlotId;\n    }\n    get id() {\n        return `${this.timeSlotId}_${this.state.roleId}`;\n    }\n    get roleId() {\n        return this.state.roleId;\n    }\n    get requiredCount() {\n        return this.state.requiredCount;\n    }\n    get minCount() {\n        return this.state.minCount ?? this.state.requiredCount;\n    }\n    get maxCount() {\n        return this.state.maxCount ?? this.state.requiredCount;\n    }\n}\n// ========== 時間帯クラス ==========\nexport class TimeSlot_時間帯 {\n    state;\n    _requirements;\n    constructor(state) {\n        this.state = state;\n        this._requirements = state.staffRequirements.map((req) => new StaffRequirement_必要人数(req, state.id));\n    }\n    get id() {\n        return this.state.id;\n    }\n    get date() {\n        return this.state.date;\n    }\n    get period() {\n        return this.state.period;\n    }\n    get label() {\n        return this.state.label;\n    }\n    get isOrientation() {\n        return this.state.isOrientation;\n    }\n    /** この時間帯の必要人数設定一覧 */\n    get staffRequirements() {\n        return this._requirements;\n    }\n    /** 特定の係の必要人数を取得 */\n    getRequirementForRole(roleId) {\n        return this._requirements.find((req) => req.roleId === roleId);\n    }\n    /** 同じ日付かどうか */\n    isSameDate(other) {\n        return this.state.date === other.state.date;\n    }\n    /** この時間帯と重複するかどうか */\n    overlaps(other) {\n        return this.state.id === other.state.id;\n    }\n    /** 時間帯の長さ（時間単位） */\n    getDurationHours() {\n        const [startH, startM] = this.state.startTime.split(':').map(Number);\n        const [endH, endM] = this.state.endTime.split(':').map(Number);\n        return (endH * 60 + endM - startH * 60 - startM) / 60;\n    }\n    // TimeSlotはマスターデータのため、更新メソッドは提供しない\n    /** 時間帯区分の日本語ラベルを取得 */\n    static getPeriodLabel(period) {\n        const labels = {\n            all_day: '終日',\n            morning: '午前',\n            afternoon: '午後',\n            evening: '夕刻',\n            party: '懇親会',\n        };\n        return labels[period];\n    }\n    /** IDから時間帯を生成するヘルパー */\n    static createId(date, period) {\n        return `${date}_${period}`;\n    }\n    /** 2025年学会のデフォルト時間帯を生成（必要人数データ含む） */\n    static createDefaultTimeSlots() {\n        // 通常の時間帯用の必要人数（会期中）\n        const standardRequirements = [\n            { roleId: 'headquarters', requiredCount: 2, minCount: 2, maxCount: 3 },\n            { roleId: 'reception', requiredCount: 3, minCount: 2, maxCount: 4 },\n            { roleId: 'badge_reissue', requiredCount: 2, minCount: 1, maxCount: 3 },\n            { roleId: 'cloakroom', requiredCount: 3, minCount: 2, maxCount: 4 },\n            { roleId: 'venue', requiredCount: 4, minCount: 3, maxCount: 5 },\n            { roleId: 'venue_check', requiredCount: 2, minCount: 1, maxCount: 3 },\n            { roleId: 'preview_room', requiredCount: 2, minCount: 1, maxCount: 2 },\n            { roleId: 'mobile_support', requiredCount: 2, minCount: 1, maxCount: 3 },\n            { roleId: 'exhibition', requiredCount: 2, minCount: 1, maxCount: 3 },\n            { roleId: 'poster', requiredCount: 2, minCount: 1, maxCount: 3 },\n        ];\n        // 準備日用の必要人数\n        const prepRequirements = [\n            { roleId: 'headquarters', requiredCount: 2, minCount: 1, maxCount: 2 },\n            { roleId: 'setup', requiredCount: 6, minCount: 4, maxCount: 8 },\n        ];\n        // 夕刻用の必要人数（少なめ）\n        const eveningRequirements = [\n            { roleId: 'headquarters', requiredCount: 2, minCount: 1, maxCount: 2 },\n            { roleId: 'reception', requiredCount: 2, minCount: 1, maxCount: 2 },\n            { roleId: 'venue', requiredCount: 2, minCount: 1, maxCount: 3 },\n            { roleId: 'mobile_support', requiredCount: 1, minCount: 1, maxCount: 2 },\n        ];\n        // 懇親会用の必要人数\n        const partyRequirements = [\n            { roleId: 'party_cloakroom', requiredCount: 3, minCount: 2, maxCount: 4 },\n            { roleId: 'party_reception', requiredCount: 4, minCount: 3, maxCount: 5 },\n        ];\n        // 撤去日用の必要人数\n        const teardownRequirements = [\n            { roleId: 'headquarters', requiredCount: 2, minCount: 1, maxCount: 2 },\n            { roleId: 'setup', requiredCount: 8, minCount: 6, maxCount: 10 },\n        ];\n        const slots = [\n            // 3/17（月）準備日\n            {\n                id: '2025-03-17_all_day',\n                date: '2025-03-17',\n                period: 'all_day',\n                startTime: '08:00',\n                endTime: '17:00',\n                label: '3/17 終日（準備）',\n                isOrientation: false,\n                staffRequirements: prepRequirements,\n            },\n            // 3/18（火）準備日\n            {\n                id: '2025-03-18_morning',\n                date: '2025-03-18',\n                period: 'morning',\n                startTime: '08:00',\n                endTime: '13:00',\n                label: '3/18 午前',\n                isOrientation: false,\n                staffRequirements: prepRequirements,\n            },\n            {\n                id: '2025-03-18_afternoon',\n                date: '2025-03-18',\n                period: 'afternoon',\n                startTime: '13:00',\n                endTime: '17:00',\n                label: '3/18 午後（オリエン）',\n                isOrientation: true,\n                staffRequirements: prepRequirements,\n            },\n            // 3/19（水）会期1日目\n            {\n                id: '2025-03-19_morning',\n                date: '2025-03-19',\n                period: 'morning',\n                startTime: '08:00',\n                endTime: '12:00',\n                label: '3/19 午前',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-19_afternoon',\n                date: '2025-03-19',\n                period: 'afternoon',\n                startTime: '12:00',\n                endTime: '17:00',\n                label: '3/19 午後',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-19_evening',\n                date: '2025-03-19',\n                period: 'evening',\n                startTime: '17:00',\n                endTime: '20:00',\n                label: '3/19 夕刻',\n                isOrientation: false,\n                staffRequirements: eveningRequirements,\n            },\n            // 3/20（木）会期2日目\n            {\n                id: '2025-03-20_morning',\n                date: '2025-03-20',\n                period: 'morning',\n                startTime: '08:00',\n                endTime: '12:00',\n                label: '3/20 午前',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-20_afternoon',\n                date: '2025-03-20',\n                period: 'afternoon',\n                startTime: '12:00',\n                endTime: '17:00',\n                label: '3/20 午後',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-20_evening',\n                date: '2025-03-20',\n                period: 'evening',\n                startTime: '17:00',\n                endTime: '20:00',\n                label: '3/20 夕刻',\n                isOrientation: false,\n                staffRequirements: eveningRequirements,\n            },\n            {\n                id: '2025-03-20_party',\n                date: '2025-03-20',\n                period: 'party',\n                startTime: '17:00',\n                endTime: '20:30',\n                label: '3/20 交流会',\n                isOrientation: false,\n                staffRequirements: partyRequirements,\n            },\n            // 3/21（金）会期3日目\n            {\n                id: '2025-03-21_morning',\n                date: '2025-03-21',\n                period: 'morning',\n                startTime: '08:00',\n                endTime: '12:00',\n                label: '3/21 午前',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-21_afternoon',\n                date: '2025-03-21',\n                period: 'afternoon',\n                startTime: '12:00',\n                endTime: '17:00',\n                label: '3/21 午後',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-21_evening',\n                date: '2025-03-21',\n                period: 'evening',\n                startTime: '17:00',\n                endTime: '20:00',\n                label: '3/21 夕刻',\n                isOrientation: false,\n                staffRequirements: eveningRequirements,\n            },\n            // 3/22（土）会期4日目（最終日）\n            {\n                id: '2025-03-22_morning',\n                date: '2025-03-22',\n                period: 'morning',\n                startTime: '08:00',\n                endTime: '12:00',\n                label: '3/22 午前',\n                isOrientation: false,\n                staffRequirements: standardRequirements,\n            },\n            {\n                id: '2025-03-22_afternoon',\n                date: '2025-03-22',\n                period: 'afternoon',\n                startTime: '12:00',\n                endTime: '17:00',\n                label: '3/22 午後（撤去）',\n                isOrientation: false,\n                staffRequirements: teardownRequirements,\n            },\n        ];\n        return slots.map((state) => new TimeSlot_時間帯(state));\n    }\n}\n","/**\n * 係ドメインモデル\n */\n// ========== ドメインクラス ==========\nexport class Role_係 {\n    state;\n    constructor(state) {\n        this.state = state;\n    }\n    get id() {\n        return this.state.id;\n    }\n    get name() {\n        return this.state.name;\n    }\n    get description() {\n        return this.state.description;\n    }\n    get fixedness() {\n        return this.state.fixedness;\n    }\n    get requirements() {\n        return this.state.requirements;\n    }\n    get priority() {\n        return this.state.priority;\n    }\n    /** 全日固定の係かどうか */\n    isAllDayFixed() {\n        return this.state.fixedness === 'all_day_fixed';\n    }\n    /** 懇親会専用の係かどうか */\n    isPartyOnly() {\n        return this.state.fixedness === 'party_only';\n    }\n    /** 兼務可能な係かどうか */\n    isConcurrentOk() {\n        return this.state.fixedness === 'concurrent_ok';\n    }\n    // Roleはマスターデータのため、更新メソッドは提供しない\n    /** 固定性の日本語ラベルを取得 */\n    static getFixednessLabel(fixedness) {\n        const labels = {\n            all_day_fixed: '全日固定',\n            time_slot_ok: '時間帯替わりOK',\n            concurrent_ok: '兼務可能',\n            party_only: '懇親会専用',\n        };\n        return labels[fixedness];\n    }\n    /** スキルレベルの数値変換 */\n    static skillLevelToNumber(level) {\n        const values = {\n            none: 0,\n            beginner: 1,\n            intermediate: 2,\n            advanced: 3,\n        };\n        return values[level];\n    }\n    /** スキルレベルの日本語ラベルを取得 */\n    static getSkillLevelLabel(level) {\n        const labels = {\n            none: 'なし',\n            beginner: '初級',\n            intermediate: '中級',\n            advanced: '上級',\n        };\n        return labels[level];\n    }\n    /** 13種類のデフォルト係を生成 */\n    static createDefaultRoles() {\n        const roles = [\n            {\n                id: 'headquarters',\n                name: '大会センター',\n                description: '運営中枢。PC・Zoom上級、全日程参加必須',\n                fixedness: 'all_day_fixed',\n                requirements: {\n                    minPcSkill: 'advanced',\n                    minZoomSkill: 'advanced',\n                },\n                priority: 100,\n            },\n            {\n                id: 'reception',\n                name: '受付案内',\n                description: '案内対応。英語力あれば優先',\n                fixedness: 'time_slot_ok',\n                requirements: {\n                    requireEnglish: false,\n                },\n                priority: 80,\n            },\n            {\n                id: 'badge_reissue',\n                name: '名札交換',\n                description: 'PC入力中心。正確性重視',\n                fixedness: 'time_slot_ok',\n                requirements: {\n                    minPcSkill: 'intermediate',\n                },\n                priority: 70,\n            },\n            {\n                id: 'cloakroom',\n                name: '手荷物預かり',\n                description: '荷物の受け渡し。体力・スピード重視',\n                fixedness: 'time_slot_ok',\n                requirements: {},\n                priority: 60,\n            },\n            {\n                id: 'venue',\n                name: 'ホール係',\n                description: '会場案内・進行補助。Zoom中級、英語あれば優先',\n                fixedness: 'time_slot_ok',\n                requirements: {\n                    minZoomSkill: 'intermediate',\n                },\n                priority: 85,\n            },\n            {\n                id: 'venue_check',\n                name: '配信確認係',\n                description: '配信チェック・機材確認。Zoom・PC中級、イベント経験者優先',\n                fixedness: 'time_slot_ok',\n                requirements: {\n                    minPcSkill: 'intermediate',\n                    minZoomSkill: 'intermediate',\n                    requireEventExperience: false,\n                },\n                priority: 90,\n            },\n            {\n                id: 'preview_room',\n                name: 'プレビュー係',\n                description: '発表データ確認など、静かな作業',\n                fixedness: 'time_slot_ok',\n                requirements: {\n                    minPcSkill: 'beginner',\n                },\n                priority: 50,\n            },\n            {\n                id: 'mobile_support',\n                name: '応援要員',\n                description: '欠員・トラブル時の応援要員',\n                fixedness: 'time_slot_ok',\n                requirements: {\n                    minPcSkill: 'intermediate',\n                    minZoomSkill: 'intermediate',\n                },\n                priority: 75,\n            },\n            {\n                id: 'setup',\n                name: '準備係',\n                description: '会場設営。男性優先（力仕事）',\n                fixedness: 'concurrent_ok',\n                requirements: {\n                    preferMale: true,\n                },\n                priority: 65,\n            },\n            {\n                id: 'exhibition',\n                name: 'ブース係',\n                description: '企業・展示ブース対応。英語できると尚可',\n                fixedness: 'time_slot_ok',\n                requirements: {},\n                priority: 55,\n            },\n            {\n                id: 'poster',\n                name: '掲示係',\n                description: 'ポスター会場案内・誘導',\n                fixedness: 'time_slot_ok',\n                requirements: {},\n                priority: 50,\n            },\n            {\n                id: 'party_cloakroom',\n                name: '交流会荷物係',\n                description: '懇親会時間に参加できるスタッフ',\n                fixedness: 'party_only',\n                requirements: {},\n                priority: 40,\n            },\n            {\n                id: 'party_reception',\n                name: '交流会案内',\n                description: '懇親会受付対応',\n                fixedness: 'party_only',\n                requirements: {},\n                priority: 40,\n            },\n        ];\n        return roles.map((state) => new Role_係(state));\n    }\n}\n","/**\n * スタッフドメインモデル\n */\nimport { Role_係 } from '../master/Role_係.js';\n// ========== ドメインクラス ==========\nexport class Staff_スタッフ {\n    state;\n    constructor(state) {\n        this.state = state;\n    }\n    get id() {\n        return this.state.id;\n    }\n    get name() {\n        return this.state.name;\n    }\n    get email() {\n        return this.state.email;\n    }\n    get gender() {\n        return this.state.gender;\n    }\n    get skills() {\n        return this.state.skills;\n    }\n    get presentation() {\n        return this.state.presentation;\n    }\n    get availableTimeSlots() {\n        return this.state.availableTimeSlots;\n    }\n    get status() {\n        return this.state.status;\n    }\n    get aptitudeScore() {\n        return this.state.aptitudeScore;\n    }\n    /** 指定時間帯に勤務可能かどうか */\n    isAvailableAt(timeSlotId) {\n        return this.state.availableTimeSlots.includes(timeSlotId);\n    }\n    /** 発表時間帯かどうか */\n    hasPresentationAt(date, period) {\n        if (!this.state.presentation.hasPresentation)\n            return false;\n        return this.state.presentation.presentations.some((p) => p.date === date && p.period === period);\n    }\n    /** 業務オリエンテーションに参加可能かどうか */\n    canAttendOrientation(orientationSlotId) {\n        return this.state.availableTimeSlots.includes(orientationSlotId);\n    }\n    /** 係の最低要件を満たしているかどうか */\n    meetsRoleRequirements(role) {\n        const req = role.requirements;\n        const skills = this.state.skills;\n        if (req.minPcSkill) {\n            if (Role_係.skillLevelToNumber(skills.pc) <\n                Role_係.skillLevelToNumber(req.minPcSkill)) {\n                return false;\n            }\n        }\n        if (req.minZoomSkill) {\n            if (Role_係.skillLevelToNumber(skills.zoom) <\n                Role_係.skillLevelToNumber(req.minZoomSkill)) {\n                return false;\n            }\n        }\n        if (req.requireEnglish && skills.english === 'none') {\n            return false;\n        }\n        if (req.requireEventExperience && !skills.eventExperience) {\n            return false;\n        }\n        return true;\n    }\n    // ========== 状態変更メソッド（意味のある操作のみ公開） ==========\n    /** 採用する */\n    accept() {\n        return this.withUpdatedState({ status: 'accepted' });\n    }\n    /** 補欠にする */\n    putOnWaitlist() {\n        return this.withUpdatedState({ status: 'waitlist' });\n    }\n    /** 不採用にする */\n    reject() {\n        return this.withUpdatedState({ status: 'rejected' });\n    }\n    /** 適性スコアを設定（マッチング処理で使用） */\n    withAptitudeScore(score) {\n        return this.withUpdatedState({ aptitudeScore: score });\n    }\n    /** 備考を更新 */\n    withNotes(notes) {\n        return this.withUpdatedState({ notes });\n    }\n    /** 内部用：状態更新ヘルパー（外部からは呼び出さない） */\n    withUpdatedState(partial) {\n        return new Staff_スタッフ({\n            ...this.state,\n            ...partial,\n            updatedAt: new Date().toISOString(),\n        });\n    }\n    // ========== シリアライズ ==========\n    /** Redux/JSON用にシリアライズ */\n    toJSON() {\n        return {\n            id: this.state.id,\n            name: this.state.name,\n            furigana: this.state.furigana,\n            email: this.state.email,\n            phone: this.state.phone,\n            school: this.state.school,\n            grade: this.state.grade,\n            gender: this.state.gender,\n            skills: { ...this.state.skills },\n            presentation: {\n                hasPresentation: this.state.presentation.hasPresentation,\n                presentations: [...this.state.presentation.presentations],\n            },\n            availableTimeSlots: [...this.state.availableTimeSlots],\n            notes: this.state.notes,\n            status: this.state.status,\n            aptitudeScore: this.state.aptitudeScore,\n            createdAt: this.state.createdAt,\n            updatedAt: this.state.updatedAt,\n        };\n    }\n    /** JSONからドメインオブジェクトを復元 */\n    static fromJSON(json) {\n        return new Staff_スタッフ(json);\n    }\n    // ========== 静的メソッド ==========\n    /** ステータスの日本語ラベルを取得 */\n    static getStatusLabel(status) {\n        const labels = {\n            pending: '審査中',\n            accepted: '採用',\n            waitlist: '補欠',\n            rejected: '不採用',\n        };\n        return labels[status];\n    }\n    /** 性別の日本語ラベルを取得 */\n    static getGenderLabel(gender) {\n        const labels = {\n            male: '男性',\n            female: '女性',\n            other: 'その他',\n            prefer_not_to_say: '回答しない',\n        };\n        return labels[gender];\n    }\n    /** 新しいスタッフを作成 */\n    static create(data) {\n        const now = new Date().toISOString();\n        return new Staff_スタッフ({\n            ...data,\n            id: crypto.randomUUID(),\n            status: 'pending',\n            createdAt: now,\n            updatedAt: now,\n        });\n    }\n}\n","/**\n * シフト配置ドメインモデル\n */\n// ========== ドメインクラス ==========\nexport class ShiftAssignment_シフト配置 {\n    state;\n    constructor(state) {\n        this.state = state;\n    }\n    get id() {\n        return this.state.id;\n    }\n    get staffId() {\n        return this.state.staffId;\n    }\n    get timeSlotId() {\n        return this.state.timeSlotId;\n    }\n    get roleId() {\n        return this.state.roleId;\n    }\n    get isAutoAssigned() {\n        return this.state.isAutoAssigned;\n    }\n    get notes() {\n        return this.state.notes;\n    }\n    /** 手動配置に変更（自動配置を上書き） */\n    markAsManuallyAssigned() {\n        return new ShiftAssignment_シフト配置({ ...this.state, isAutoAssigned: false });\n    }\n    /** 備考を追加 */\n    withNotes(notes) {\n        return new ShiftAssignment_シフト配置({ ...this.state, notes });\n    }\n    // ShiftAssignmentは基本的に作成後は削除して再作成するため、汎用updateは提供しない\n    /** 新しい配置を作成 */\n    static create(staffId, timeSlotId, roleId, isAutoAssigned = true) {\n        return new ShiftAssignment_シフト配置({\n            id: crypto.randomUUID(),\n            staffId,\n            timeSlotId,\n            roleId,\n            isAutoAssigned,\n        });\n    }\n}\n","/**\n * 配置枠評価ドメインモデル\n * 時間帯×係（配置枠）レベルでの人員充足状況を評価する\n */\n// ========== ドメインクラス ==========\nexport class SlotRoleEvaluation_配置枠評価 {\n    state;\n    constructor(state) {\n        this.state = state;\n    }\n    get timeSlotId() {\n        return this.state.timeSlotId;\n    }\n    get roleId() {\n        return this.state.roleId;\n    }\n    get requiredCount() {\n        return this.state.requiredCount;\n    }\n    get assignedCount() {\n        return this.state.assignedCount;\n    }\n    get assignedStaffIds() {\n        return this.state.assignedStaffIds;\n    }\n    get fulfillmentRate() {\n        return this.state.fulfillmentRate;\n    }\n    get hasShortage() {\n        return this.state.hasShortage;\n    }\n    get hasExcess() {\n        return this.state.hasExcess;\n    }\n    // SlotRoleEvaluationは計算結果のため、更新メソッドは提供しない\n    /** 配置状況から評価を行う */\n    static evaluate(requirement, assignedStaffIds) {\n        const assignedCount = assignedStaffIds.length;\n        const requiredCount = requirement.requiredCount;\n        const fulfillmentRate = requiredCount > 0 ? (assignedCount / requiredCount) * 100 : 100;\n        return new SlotRoleEvaluation_配置枠評価({\n            timeSlotId: requirement.timeSlotId,\n            roleId: requirement.roleId,\n            requiredCount,\n            assignedCount,\n            assignedStaffIds,\n            fulfillmentRate,\n            hasShortage: assignedCount < requirement.minCount,\n            hasExcess: assignedCount > requirement.maxCount,\n        });\n    }\n}\n","/**\n * シフト案ドメインモデル\n * 全配置を取りまとめて、シフト全体の評価を行う\n */\nimport { ShiftAssignment_シフト配置 } from './ShiftAssignment_シフト配置.js';\nimport { SlotRoleEvaluation_配置枠評価 } from './SlotRoleEvaluation_配置枠評価.js';\n// ========== ドメインクラス ==========\nexport class ShiftPlan_シフト案 {\n    state;\n    constructor(state) {\n        this.state = state;\n    }\n    get id() {\n        return this.state.id;\n    }\n    get name() {\n        return this.state.name;\n    }\n    get assignments() {\n        return this.state.assignments.map((s) => new ShiftAssignment_シフト配置(s));\n    }\n    get constraintViolations() {\n        // 既存データとの互換性: constraintViolationsがなければ計算\n        return this.state.constraintViolations ?? ShiftPlan_シフト案.computeConstraintViolations(this.state.assignments);\n    }\n    /** 特定スタッフの配置を取得 */\n    getAssignmentsByStaff(staffId) {\n        return this.assignments.filter((a) => a.staffId === staffId);\n    }\n    /** 特定時間帯の配置を取得 */\n    getAssignmentsByTimeSlot(timeSlotId) {\n        return this.assignments.filter((a) => a.timeSlotId === timeSlotId);\n    }\n    /** 特定係の配置を取得 */\n    getAssignmentsByRole(roleId) {\n        return this.assignments.filter((a) => a.roleId === roleId);\n    }\n    /** 特定の時間帯×係の配置を取得 */\n    getAssignmentsForSlotRole(timeSlotId, roleId) {\n        return this.assignments.filter((a) => a.timeSlotId === timeSlotId && a.roleId === roleId);\n    }\n    /** シフト案を評価（必要人数と照合） */\n    evaluate(requirements) {\n        const slotRoleEvaluations = [];\n        for (const req of requirements) {\n            const assignedStaffIds = this.getAssignmentsForSlotRole(req.timeSlotId, req.roleId).map((a) => a.staffId);\n            const evaluation = SlotRoleEvaluation_配置枠評価.evaluate(req, assignedStaffIds);\n            slotRoleEvaluations.push(evaluation);\n        }\n        const totalAssignmentCount = this.state.assignments.length;\n        const shortageCount = slotRoleEvaluations.filter((e) => e.hasShortage).length;\n        const excessCount = slotRoleEvaluations.filter((e) => e.hasExcess).length;\n        const totalFulfillmentRate = slotRoleEvaluations.length > 0\n            ? slotRoleEvaluations.reduce((sum, e) => sum + e.fulfillmentRate, 0) /\n                slotRoleEvaluations.length\n            : 100;\n        return {\n            totalAssignmentCount,\n            totalFulfillmentRate,\n            shortageCount,\n            excessCount,\n            slotRoleEvaluations,\n        };\n    }\n    /** 総合スコアを計算（高いほど良い） */\n    calculateOverallScore(requirements) {\n        const evaluation = this.evaluate(requirements);\n        // 充足率をベースに、不足・過剰でペナルティ\n        let score = evaluation.totalFulfillmentRate;\n        score -= evaluation.shortageCount * 5; // 不足1件につき-5点\n        score -= evaluation.excessCount * 2; // 過剰1件につき-2点\n        return Math.max(0, score);\n    }\n    // ========== 制約違反 ==========\n    /** 制約違反を取得 */\n    detectConstraintViolations() {\n        return this.constraintViolations;\n    }\n    /** 制約違反があるかどうか */\n    hasConstraintViolations() {\n        return this.constraintViolations.length > 0;\n    }\n    /** 特定の配置が制約違反に含まれているか */\n    isAssignmentInViolation(assignmentId) {\n        return this.constraintViolations.some((v) => v.assignmentIds.includes(assignmentId));\n    }\n    /** 特定のスタッフ×時間帯の組み合わせが制約違反か */\n    isStaffTimeSlotInViolation(staffId, timeSlotId) {\n        return this.constraintViolations.some((v) => v.staffId === staffId && v.timeSlotId === timeSlotId);\n    }\n    /** 配置リストから制約違反を計算 */\n    static computeConstraintViolations(assignments) {\n        const violations = [];\n        // 同一時間帯に同じスタッフが複数配置されている場合を検出\n        const groupedByTimeSlotAndStaff = new Map();\n        for (const assignment of assignments) {\n            const key = `${assignment.timeSlotId}:${assignment.staffId}`;\n            const existing = groupedByTimeSlotAndStaff.get(key) ?? [];\n            existing.push(assignment);\n            groupedByTimeSlotAndStaff.set(key, existing);\n        }\n        // 2件以上あるものを違反として報告\n        for (const [key, grouped] of groupedByTimeSlotAndStaff) {\n            if (grouped.length > 1) {\n                const [timeSlotId, staffId] = key.split(':');\n                violations.push({\n                    type: 'duplicate_staff_in_timeslot',\n                    staffId,\n                    timeSlotId,\n                    assignmentIds: grouped.map((a) => a.id),\n                    message: `同一時間帯に同じスタッフが${grouped.length}件配置されています`,\n                });\n            }\n        }\n        return violations;\n    }\n    // ========== 状態変更メソッド ==========\n    /** 配置を追加 */\n    addAssignment(assignment) {\n        return this.withUpdatedState({\n            assignments: [...this.state.assignments, assignment.state],\n        });\n    }\n    /** 配置を削除 */\n    removeAssignment(assignmentId) {\n        return this.withUpdatedState({\n            assignments: this.state.assignments.filter((a) => a.id !== assignmentId),\n        });\n    }\n    /** 名前を変更 */\n    withName(name) {\n        return this.withUpdatedState({ name });\n    }\n    /** 内部用：状態更新ヘルパー */\n    withUpdatedState(partial) {\n        const newAssignments = partial.assignments ?? this.state.assignments;\n        const constraintViolations = partial.assignments\n            ? ShiftPlan_シフト案.computeConstraintViolations(newAssignments)\n            : this.state.constraintViolations;\n        return new ShiftPlan_シフト案({\n            ...this.state,\n            ...partial,\n            constraintViolations,\n            updatedAt: new Date().toISOString(),\n        });\n    }\n    // ========== 静的メソッド ==========\n    /** 新しいシフト案を作成 */\n    static create(name) {\n        const now = new Date().toISOString();\n        return new ShiftPlan_シフト案({\n            id: crypto.randomUUID(),\n            name,\n            assignments: [],\n            constraintViolations: [],\n            createdAt: now,\n            updatedAt: now,\n        });\n    }\n}\n","/**\n * スタッフ配置評価ドメインモデル\n * 個別のスタッフ配置に対する適性評価を行う\n */\nimport { Role_係 } from '../master/Role_係.js';\n// ========== ドメインクラス ==========\nexport class StaffAssignmentEvaluation_スタッフ配置評価 {\n    state;\n    constructor(state) {\n        this.state = state;\n    }\n    get assignmentId() {\n        return this.state.assignmentId;\n    }\n    get staffId() {\n        return this.state.staffId;\n    }\n    get timeSlotId() {\n        return this.state.timeSlotId;\n    }\n    get roleId() {\n        return this.state.roleId;\n    }\n    get isAvailable() {\n        return this.state.isAvailable;\n    }\n    get meetsRequirements() {\n        return this.state.meetsRequirements;\n    }\n    get hasPresentationConflict() {\n        return this.state.hasPresentationConflict;\n    }\n    get skillMatches() {\n        return this.state.skillMatches;\n    }\n    get roleFitScore() {\n        return this.state.roleFitScore;\n    }\n    get totalScore() {\n        return this.state.totalScore;\n    }\n    get issues() {\n        return this.state.issues;\n    }\n    /** 総合評価ステータスを取得 */\n    getOverallStatus() {\n        const { issues, totalScore } = this.state;\n        // エラーレベルの問題がある場合\n        if (!this.state.isAvailable || this.state.hasPresentationConflict) {\n            return 'error';\n        }\n        // 要件を満たさない場合\n        if (!this.state.meetsRequirements) {\n            return 'warning';\n        }\n        // スコアに基づく評価\n        if (totalScore >= 10)\n            return 'excellent';\n        if (totalScore >= 5)\n            return 'good';\n        if (totalScore >= 0)\n            return 'acceptable';\n        if (issues.length > 0)\n            return 'warning';\n        return 'acceptable';\n    }\n    /** ステータスの日本語ラベルを取得 */\n    static getStatusLabel(status) {\n        const labels = {\n            excellent: '最適',\n            good: '良好',\n            acceptable: '可',\n            warning: '注意',\n            error: '問題あり',\n        };\n        return labels[status];\n    }\n    /** 配置を評価（既存配置の評価用） */\n    static evaluate(assignment, staff, role, timeSlot) {\n        const result = this.evaluateCore(staff, role, timeSlot);\n        return new StaffAssignmentEvaluation_スタッフ配置評価({\n            ...result,\n            assignmentId: assignment.id,\n        });\n    }\n    /**\n     * 候補者を評価（配置前の仮評価用）\n     * ShiftMatcherなどのマッチングアルゴリズムから使用\n     */\n    static evaluateCandidate(staff, role, timeSlot) {\n        const result = this.evaluateCore(staff, role, timeSlot);\n        return new StaffAssignmentEvaluation_スタッフ配置評価({\n            ...result,\n            assignmentId: '', // 配置前なのでID未定\n        });\n    }\n    /** 評価の共通ロジック */\n    static evaluateCore(staff, role, timeSlot) {\n        const issues = [];\n        // 1. 時間帯の参加可否\n        const isAvailable = staff.isAvailableAt(timeSlot.id);\n        if (!isAvailable) {\n            issues.push('この時間帯に参加できません');\n        }\n        // 2. 発表との重複チェック\n        const hasPresentationConflict = staff.hasPresentationAt(timeSlot.date, timeSlot.period);\n        if (hasPresentationConflict) {\n            issues.push('発表と時間が重複しています');\n        }\n        // 3. 係の要件チェック\n        const meetsRequirements = staff.meetsRoleRequirements(role);\n        if (!meetsRequirements) {\n            issues.push('係の要件を満たしていません');\n        }\n        // 4. スキルマッチング詳細と適性スコア計算\n        const skillMatches = this.evaluateSkillMatches(staff, role);\n        const roleFitScore = skillMatches.reduce((sum, m) => sum + m.scoreDiff, 0);\n        // 5. 総合スコア計算\n        let totalScore = roleFitScore;\n        if (!isAvailable)\n            totalScore -= 10;\n        if (hasPresentationConflict)\n            totalScore -= 10;\n        if (!meetsRequirements)\n            totalScore -= 10;\n        return {\n            staffId: staff.id,\n            timeSlotId: timeSlot.id,\n            roleId: role.id,\n            isAvailable,\n            meetsRequirements,\n            hasPresentationConflict,\n            skillMatches,\n            roleFitScore,\n            totalScore,\n            issues,\n        };\n    }\n    /** スキルマッチングを評価 */\n    static evaluateSkillMatches(staff, role) {\n        const matches = [];\n        const req = role.requirements;\n        const skills = staff.skills;\n        // PCスキル: 係が求めている場合のみ評価（求めていない場合はscoreDiff: 0）\n        // 要件を満たしていれば差分+1、満たしていなければ差分のまま（ペナルティ）\n        const pcRequired = req.minPcSkill ?? 'none';\n        const pcRawDiff = req.minPcSkill\n            ? Role_係.skillLevelToNumber(skills.pc) -\n                Role_係.skillLevelToNumber(req.minPcSkill)\n            : 0;\n        const pcDiff = req.minPcSkill ? (pcRawDiff >= 0 ? pcRawDiff + 1 : pcRawDiff) : 0;\n        matches.push({\n            skillName: 'PC',\n            required: pcRequired,\n            staffHas: skills.pc,\n            isMatch: pcRawDiff >= 0,\n            scoreDiff: pcDiff,\n        });\n        // Zoomスキル: 係が求めている場合のみ評価（求めていない場合はscoreDiff: 0）\n        // 要件を満たしていれば差分+1、満たしていなければ差分のまま（ペナルティ）\n        const zoomRequired = req.minZoomSkill ?? 'none';\n        const zoomRawDiff = req.minZoomSkill\n            ? Role_係.skillLevelToNumber(skills.zoom) -\n                Role_係.skillLevelToNumber(req.minZoomSkill)\n            : 0;\n        const zoomDiff = req.minZoomSkill ? (zoomRawDiff >= 0 ? zoomRawDiff + 1 : zoomRawDiff) : 0;\n        matches.push({\n            skillName: 'Zoom',\n            required: zoomRequired,\n            staffHas: skills.zoom,\n            isMatch: zoomRawDiff >= 0,\n            scoreDiff: zoomDiff,\n        });\n        // 英語スキル: 係が求めている場合のみ評価（求めていない場合はscoreDiff: 0）\n        const englishRequired = req.requireEnglish ? 'any' : 'none';\n        const englishMatch = !req.requireEnglish || skills.english === 'daily_conversation';\n        matches.push({\n            skillName: '英語',\n            required: englishRequired,\n            staffHas: skills.english === 'daily_conversation' ? '日常会話' : 'なし',\n            isMatch: englishMatch,\n            // 係が求めている場合のみ加点\n            scoreDiff: req.requireEnglish && skills.english === 'daily_conversation' ? 2 : 0,\n        });\n        // イベント経験: 係が求めている場合のみ評価（求めていない場合はscoreDiff: 0）\n        const expRequired = req.requireEventExperience ? 'any' : 'none';\n        const expMatch = !req.requireEventExperience || skills.eventExperience;\n        matches.push({\n            skillName: '経験',\n            required: expRequired,\n            staffHas: skills.eventExperience ? 'あり' : 'なし',\n            isMatch: expMatch,\n            // 係が求めている場合のみ加点\n            scoreDiff: req.requireEventExperience && skills.eventExperience ? 2 : 0,\n        });\n        // 男性優先: 係が求めている場合のみ評価（求めていない場合はscoreDiff: 0）\n        // 男性なら+2、それ以外でも+1\n        const maleRequired = req.preferMale ? 'any' : 'none';\n        const maleMatch = !req.preferMale || staff.gender === 'male';\n        const maleScore = req.preferMale ? (staff.gender === 'male' ? 2 : 1) : 0;\n        matches.push({\n            skillName: '性別',\n            required: maleRequired,\n            staffHas: staff.gender === 'male' ? '男性' : 'その他',\n            isMatch: maleMatch,\n            scoreDiff: maleScore,\n        });\n        return matches;\n    }\n}\n","/**\n * シフトマッチングサービス\n * 貪欲法による自動シフト配置アルゴリズム\n */\nimport { ShiftAssignment_シフト配置 } from './ShiftAssignment_シフト配置.js';\nimport { StaffAssignmentEvaluation_スタッフ配置評価 } from './StaffAssignmentEvaluation_スタッフ配置評価.js';\n// ========== デフォルト設定 ==========\nconst DEFAULT_OPTIONS = {\n    allowConcurrentAssignment: false,\n    maxAssignmentsPerStaff: 0, // 無制限\n    preserveExistingAssignments: true,\n};\n// ========== マッチングサービス ==========\nexport class ShiftMatcher_シフトマッチング {\n    staffList;\n    roles;\n    timeSlots;\n    requirements;\n    constructor(staffList, roles, timeSlots, requirements) {\n        this.staffList = staffList;\n        this.roles = roles;\n        this.timeSlots = timeSlots;\n        this.requirements = requirements;\n    }\n    /**\n     * 自動マッチングを実行\n     * @param existingAssignments 既存の配置（オプション）\n     * @param options マッチングオプション\n     */\n    match(existingAssignments = [], options = {}) {\n        const opts = { ...DEFAULT_OPTIONS, ...options };\n        // 既存配置を考慮\n        const assignments = opts.preserveExistingAssignments\n            ? [...existingAssignments]\n            : [];\n        // 各スタッフの配置数をトラッキング\n        const staffAssignmentCount = new Map();\n        const staffTimeSlotAssignments = new Map();\n        // 既存配置のカウントを初期化\n        for (const assignment of assignments) {\n            const count = staffAssignmentCount.get(assignment.staffId) ?? 0;\n            staffAssignmentCount.set(assignment.staffId, count + 1);\n            const slots = staffTimeSlotAssignments.get(assignment.staffId) ?? new Set();\n            slots.add(assignment.timeSlotId);\n            staffTimeSlotAssignments.set(assignment.staffId, slots);\n        }\n        // 役職を優先度順にソート（高い順）\n        const sortedRoles = [...this.roles].sort((a, b) => b.priority - a.priority);\n        // 時間帯ごと、役職ごとにマッチング\n        for (const role of sortedRoles) {\n            for (const timeSlot of this.timeSlots) {\n                // この時間帯×係の必要人数を取得\n                const requirement = this.requirements.find((r) => r.timeSlotId === timeSlot.id && r.roleId === role.id);\n                // 必要人数の設定がない場合はスキップ\n                if (!requirement) {\n                    continue;\n                }\n                const requiredCount = requirement.requiredCount;\n                // 既存配置数を確認\n                const existingCount = assignments.filter((a) => a.timeSlotId === timeSlot.id && a.roleId === role.id).length;\n                // 追加が必要な人数\n                const neededCount = Math.max(0, requiredCount - existingCount);\n                // 候補者を評価してソート\n                const candidates = this.evaluateCandidates(timeSlot, role, assignments, staffAssignmentCount, staffTimeSlotAssignments, opts);\n                // 上位から配置\n                for (let i = 0; i < neededCount && i < candidates.length; i++) {\n                    const candidate = candidates[i];\n                    // 配置を作成\n                    const assignment = ShiftAssignment_シフト配置.create(candidate.staff.id, timeSlot.id, role.id, true // 自動配置フラグ\n                    );\n                    assignments.push(assignment.state);\n                    // カウントを更新\n                    const count = staffAssignmentCount.get(candidate.staff.id) ?? 0;\n                    staffAssignmentCount.set(candidate.staff.id, count + 1);\n                    const slots = staffTimeSlotAssignments.get(candidate.staff.id) ?? new Set();\n                    slots.add(timeSlot.id);\n                    staffTimeSlotAssignments.set(candidate.staff.id, slots);\n                }\n            }\n        }\n        // 統計を計算\n        const stats = this.calculateStats(assignments, staffAssignmentCount);\n        return { assignments, stats };\n    }\n    /**\n     * 特定の時間帯×係への候補者を評価\n     */\n    evaluateCandidates(timeSlot, role, currentAssignments, staffAssignmentCount, staffTimeSlotAssignments, opts) {\n        const candidates = [];\n        for (const staff of this.staffList) {\n            const reasons = [];\n            // 1. 参加可能性チェック（必須）\n            if (!staff.isAvailableAt(timeSlot.id)) {\n                continue; // この時間帯は参加不可\n            }\n            // 2. 既にこの時間帯×係に配置されているかチェック\n            const alreadyAssigned = currentAssignments.some((a) => a.staffId === staff.id &&\n                a.timeSlotId === timeSlot.id &&\n                a.roleId === role.id);\n            if (alreadyAssigned) {\n                continue;\n            }\n            // 3. 同一時間帯への兼務チェック\n            const assignedSlots = staffTimeSlotAssignments.get(staff.id);\n            if (assignedSlots?.has(timeSlot.id) && !opts.allowConcurrentAssignment) {\n                // 兼務可能な係でなければスキップ\n                if (!role.isConcurrentOk()) {\n                    continue;\n                }\n            }\n            // 4. 最大配置数チェック\n            if (opts.maxAssignmentsPerStaff > 0) {\n                const count = staffAssignmentCount.get(staff.id) ?? 0;\n                if (count >= opts.maxAssignmentsPerStaff) {\n                    continue;\n                }\n            }\n            // 5. StaffAssignmentEvaluationで評価\n            const evaluation = StaffAssignmentEvaluation_スタッフ配置評価.evaluateCandidate(staff, role, timeSlot);\n            // ベーススコア（評価結果から取得）\n            let matchingScore = evaluation.totalScore;\n            // マッチング固有の調整を追加\n            if (evaluation.meetsRequirements) {\n                reasons.push('要件満たす');\n            }\n            else {\n                reasons.push('要件不足');\n            }\n            if (evaluation.roleFitScore > 0) {\n                reasons.push(`適性+${evaluation.roleFitScore}`);\n            }\n            // 6. 既存配置数が少ないスタッフを優先（均等配置）\n            const currentCount = staffAssignmentCount.get(staff.id) ?? 0;\n            matchingScore -= currentCount * 2;\n            if (currentCount === 0) {\n                reasons.push('未配置');\n            }\n            // 7. 参加可能時間帯が多いスタッフを優先（柔軟性）\n            const availableCount = staff.availableTimeSlots.length;\n            matchingScore += Math.min(availableCount, 5);\n            candidates.push({ staff, evaluation, matchingScore, reasons });\n        }\n        // マッチングスコア順にソート（高い順）\n        return candidates.sort((a, b) => b.matchingScore - a.matchingScore);\n    }\n    /**\n     * マッチング統計を計算\n     */\n    calculateStats(assignments, staffAssignmentCount) {\n        let filledSlots = 0;\n        let unfilledSlots = 0;\n        for (const requirement of this.requirements) {\n            const assignedCount = assignments.filter((a) => a.timeSlotId === requirement.timeSlotId &&\n                a.roleId === requirement.roleId).length;\n            if (assignedCount >= requirement.requiredCount) {\n                filledSlots++;\n            }\n            else {\n                unfilledSlots++;\n            }\n        }\n        const assignedStaffIds = new Set(assignments.map((a) => a.staffId));\n        const unassignedStaff = this.staffList.filter((s) => !assignedStaffIds.has(s.id)).length;\n        return {\n            totalAssignments: assignments.length,\n            filledSlots,\n            unfilledSlots,\n            unassignedStaff,\n        };\n    }\n    // ========== 静的ファクトリーメソッド ==========\n    /**\n     * デフォルトのマッチングを実行するシンプルなファクトリー\n     */\n    static autoAssign(staffList, roles, timeSlots, existingAssignments = [], options = {}) {\n        // TimeSlotから必要人数を抽出\n        const requirements = ShiftMatcher_シフトマッチング.extractRequirements(timeSlots);\n        const matcher = new ShiftMatcher_シフトマッチング(staffList, roles, timeSlots, requirements);\n        return matcher.match(existingAssignments, options);\n    }\n    /**\n     * TimeSlotの配列から必要人数を抽出する\n     */\n    static extractRequirements(timeSlots) {\n        const requirements = [];\n        for (const timeSlot of timeSlots) {\n            requirements.push(...timeSlot.staffRequirements);\n        }\n        return requirements;\n    }\n}\n","import { createSlice, createSelector, type WithSlice } from \"@reduxjs/toolkit\";\nimport type { PayloadAction } from \"@reduxjs/toolkit\";\nimport { rootReducer, type RootState } from \"@bublys-org/state-management\";\n\nimport {\n  type ShiftPlanState,\n  ShiftPlan_シフト案,\n} from \"@bublys-org/gakkai-shift-model\";\n\n// Re-export for convenience\nexport { ShiftPlan_シフト案 };\nexport type { ShiftPlanState };\n\n// ========== State ==========\n\ntype ShiftPlanSliceState = {\n  shiftPlans: ShiftPlanState[];\n  currentShiftPlanId: string | null;\n};\n\nconst initialState: ShiftPlanSliceState = {\n  shiftPlans: [],\n  currentShiftPlanId: null,\n};\n\n// ========== Helper ==========\n\n/** readonlyなShiftPlanStateをmutableに変換（Immer用） */\nconst toMutableShiftPlanState = (plan: ShiftPlanState) => ({\n  ...plan,\n  assignments: [...plan.assignments],\n  constraintViolations: (plan.constraintViolations ?? []).map((v) => ({\n    ...v,\n    assignmentIds: [...v.assignmentIds],\n  })),\n});\n\n// ========== Slice ==========\n\nexport const shiftPlanSlice = createSlice({\n  name: \"shiftPlan\",\n  initialState,\n  reducers: {\n    addShiftPlan: (state, action: PayloadAction<ShiftPlanState>) => {\n      if (!state.shiftPlans) {\n        state.shiftPlans = [];\n      }\n      const mutablePlan = toMutableShiftPlanState(action.payload);\n      state.shiftPlans.push(mutablePlan);\n    },\n    updateShiftPlan: (state, action: PayloadAction<ShiftPlanState>) => {\n      if (!state.shiftPlans) state.shiftPlans = [];\n      const index = state.shiftPlans.findIndex((p) => p.id === action.payload.id);\n      if (index !== -1) {\n        state.shiftPlans[index] = toMutableShiftPlanState(action.payload);\n      }\n    },\n    setCurrentShiftPlanId: (state, action: PayloadAction<string | null>) => {\n      state.currentShiftPlanId = action.payload;\n    },\n    deleteShiftPlan: (state, action: PayloadAction<string>) => {\n      if (!state.shiftPlans) state.shiftPlans = [];\n      state.shiftPlans = state.shiftPlans.filter((p) => p.id !== action.payload);\n      if (state.currentShiftPlanId === action.payload) {\n        state.currentShiftPlanId = state.shiftPlans.length > 0 ? state.shiftPlans[0].id : null;\n      }\n    },\n  },\n});\n\nexport const {\n  addShiftPlan,\n  updateShiftPlan,\n  deleteShiftPlan,\n  setCurrentShiftPlanId,\n} = shiftPlanSlice.actions;\n\n// LazyLoadedSlicesを拡張して型を追加\ndeclare module \"@bublys-org/state-management\" {\n  export interface LazyLoadedSlices extends WithSlice<typeof shiftPlanSlice> {}\n}\n\n// rootReducerに注入（副作用として実行）\nshiftPlanSlice.injectInto(rootReducer);\n\n// ========== Selectors ==========\n\n// セレクター用の型\ntype StateWithShiftPlan = RootState & { shiftPlan: ShiftPlanSliceState };\n\n// 基本セレクター\nconst selectShiftPlansRaw = (state: StateWithShiftPlan) => state.shiftPlan?.shiftPlans ?? [];\n\n/** シフト案一覧を取得（ドメインオブジェクト） */\nexport const selectShiftPlans = createSelector(\n  [selectShiftPlansRaw],\n  (shiftPlans): ShiftPlan_シフト案[] => shiftPlans.map((s) => new ShiftPlan_シフト案(s))\n);\n\n/** 現在のシフト案IDを取得 */\nexport const selectCurrentShiftPlanId = (state: StateWithShiftPlan): string | null =>\n  state.shiftPlan?.currentShiftPlanId ?? null;\n\n/** IDでシフト案を取得（ドメインオブジェクト） */\nexport const selectShiftPlanById = (id: string) =>\n  createSelector(\n    [(state: StateWithShiftPlan) => (state.shiftPlan?.shiftPlans ?? []).find((p) => p.id === id)],\n    (plan): ShiftPlan_シフト案 | undefined => {\n      return plan ? new ShiftPlan_シフト案(plan) : undefined;\n    }\n  );\n\n/** 現在のシフト案を取得（ドメインオブジェクト） */\nexport const selectCurrentShiftPlan = createSelector(\n  [(state: StateWithShiftPlan) => {\n    const id = state.shiftPlan?.currentShiftPlanId;\n    if (!id) return undefined;\n    return (state.shiftPlan?.shiftPlans ?? []).find((p) => p.id === id);\n  }],\n  (plan): ShiftPlan_シフト案 | undefined => {\n    return plan ? new ShiftPlan_シフト案(plan) : undefined;\n  }\n);\n","import { createSlice, createSelector, type WithSlice } from \"@reduxjs/toolkit\";\nimport type { PayloadAction } from \"@reduxjs/toolkit\";\nimport { rootReducer, type RootState } from \"@bublys-org/state-management\";\n\n// ドメインモデルからインポート\nimport {\n  Staff_スタッフ,\n  type StaffJSON,\n  type StaffStatus_ステータス,\n} from \"@bublys-org/gakkai-shift-model\";\n\n// Re-export for convenience\nexport { Staff_スタッフ };\nexport type { StaffJSON, StaffStatus_ステータス };\n\n// ShiftPlan関連は shift-plan-slice から再エクスポート（後方互換性）\nexport {\n  shiftPlanSlice,\n  addShiftPlan,\n  updateShiftPlan,\n  deleteShiftPlan,\n  setCurrentShiftPlanId,\n  selectShiftPlans as selectGakkaiShiftPlans,\n  selectCurrentShiftPlanId as selectGakkaiShiftCurrentPlanId,\n  selectShiftPlanById as selectGakkaiShiftPlanById,\n  selectCurrentShiftPlan as selectGakkaiShiftCurrentPlan,\n  ShiftPlan_シフト案,\n  type ShiftPlanState,\n} from \"./shift-plan-slice.js\";\n\n// ========== State ==========\n\ntype GakkaiShiftStaffState = {\n  staffList: StaffJSON[];\n  selectedStaffId: string | null;\n};\n\nconst initialState: GakkaiShiftStaffState = {\n  staffList: [],\n  selectedStaffId: null,\n};\n\n// ========== Slice ==========\n\nexport const gakkaiShiftSlice = createSlice({\n  name: \"gakkaiShift\",\n  initialState,\n  reducers: {\n    setStaffList: (state, action: PayloadAction<StaffJSON[]>) => {\n      state.staffList = action.payload;\n    },\n    addStaff: (state, action: PayloadAction<StaffJSON>) => {\n      state.staffList.push(action.payload);\n    },\n    updateStaff: (state, action: PayloadAction<StaffJSON>) => {\n      const index = state.staffList.findIndex((s) => s.id === action.payload.id);\n      if (index !== -1) {\n        state.staffList[index] = action.payload;\n      }\n    },\n    deleteStaff: (state, action: PayloadAction<string>) => {\n      state.staffList = state.staffList.filter((s) => s.id !== action.payload);\n    },\n    setSelectedStaffId: (state, action: PayloadAction<string | null>) => {\n      state.selectedStaffId = action.payload;\n    },\n    updateStaffStatus: (\n      state,\n      action: PayloadAction<{ id: string; status: StaffStatus_ステータス }>\n    ) => {\n      const staff = state.staffList.find((s) => s.id === action.payload.id);\n      if (staff) {\n        staff.status = action.payload.status;\n        staff.updatedAt = new Date().toISOString();\n      }\n    },\n  },\n});\n\nexport const {\n  setStaffList,\n  addStaff,\n  updateStaff,\n  deleteStaff,\n  setSelectedStaffId,\n  updateStaffStatus,\n} = gakkaiShiftSlice.actions;\n\n// LazyLoadedSlicesを拡張して型を追加\ndeclare module \"@bublys-org/state-management\" {\n  export interface LazyLoadedSlices extends WithSlice<typeof gakkaiShiftSlice> {}\n}\n\n// rootReducerに注入（副作用として実行）\ngakkaiShiftSlice.injectInto(rootReducer);\n\n// ========== Selectors ==========\n\n// セレクター用の型\ntype StateWithGakkaiShift = RootState & { gakkaiShift: GakkaiShiftStaffState };\n\n// 基本セレクター\nconst selectStaffListRaw = (state: StateWithGakkaiShift) => state.gakkaiShift?.staffList ?? [];\n\n/** スタッフ一覧を取得（ドメインオブジェクト） */\nexport const selectGakkaiShiftStaffList = createSelector(\n  [selectStaffListRaw],\n  (staffList): Staff_スタッフ[] => staffList.map((json) => Staff_スタッフ.fromJSON(json))\n);\n\n/** 選択中のスタッフIDを取得 */\nexport const selectGakkaiShiftSelectedStaffId = (state: StateWithGakkaiShift): string | null =>\n  state.gakkaiShift?.selectedStaffId ?? null;\n\n/** IDでスタッフを取得（ドメインオブジェクト） */\nexport const selectGakkaiShiftStaffById = (id: string) =>\n  createSelector(\n    [(state: StateWithGakkaiShift) => (state.gakkaiShift?.staffList ?? []).find((s) => s.id === id)],\n    (json): Staff_スタッフ | undefined => {\n      return json ? Staff_スタッフ.fromJSON(json) : undefined;\n    }\n  );\n\n/** ステータスでスタッフを絞り込み（ドメインオブジェクト） */\nexport const selectGakkaiShiftStaffByStatus = (status: StaffStatus_ステータス) =>\n  createSelector(\n    [selectStaffListRaw],\n    (staffList): Staff_スタッフ[] =>\n      staffList\n        .filter((s) => s.status === status)\n        .map((json) => Staff_スタッフ.fromJSON(json))\n  );\n\n/** 選択中のスタッフを取得（ドメインオブジェクト） */\nexport const selectGakkaiShiftSelectedStaff = createSelector(\n  [(state: StateWithGakkaiShift) => {\n    const id = state.gakkaiShift?.selectedStaffId;\n    if (!id) return undefined;\n    return (state.gakkaiShift?.staffList ?? []).find((s) => s.id === id);\n  }],\n  (json): Staff_スタッフ | undefined => {\n    return json ? Staff_スタッフ.fromJSON(json) : undefined;\n  }\n);\n","'use client';\n\nimport { FC, ReactNode } from \"react\";\nimport styled from \"styled-components\";\nimport { Staff_スタッフ, Role_係, SkillLevel_スキルレベル } from \"../domain/index.js\";\nimport PersonIcon from \"@mui/icons-material/Person\";\nimport { ObjectView } from \"@bublys-org/bubbles-ui\";\n\n/** フィルターで絞り込まれたスキルの情報 */\nexport type FilteredSkills = {\n  pc?: { level: SkillLevel_スキルレベル; operator: '>=' | '=' };\n  zoom?: { level: SkillLevel_スキルレベル; operator: '>=' | '=' };\n  english?: boolean;\n  eventExperience?: boolean;\n};\n\ntype StaffListViewProps = {\n  staffList: Staff_スタッフ[];\n  selectedStaffId?: string | null;\n  buildDetailUrl: (staffId: string) => string;\n  onStaffClick?: (staffId: string) => void;\n  /** フィルターで絞り込まれたスキル（表示用） */\n  filteredSkills?: FilteredSkills;\n};\n\nexport const StaffListView: FC<StaffListViewProps> = ({\n  staffList,\n  selectedStaffId,\n  buildDetailUrl,\n  onStaffClick,\n  filteredSkills,\n}) => {\n  /** フィルターに関連するスキルのバッジを生成 */\n  const renderSkillBadges = (staff: Staff_スタッフ) => {\n    if (!filteredSkills) return null;\n\n    const badges: ReactNode[] = [];\n\n    if (filteredSkills.pc) {\n      const label = Role_係.getSkillLevelLabel(staff.skills.pc);\n      badges.push(\n        <span key=\"pc\" className=\"e-skill-badge e-skill-badge--pc\">\n          PC: {label}\n        </span>\n      );\n    }\n\n    if (filteredSkills.zoom) {\n      const label = Role_係.getSkillLevelLabel(staff.skills.zoom);\n      badges.push(\n        <span key=\"zoom\" className=\"e-skill-badge e-skill-badge--zoom\">\n          Zoom: {label}\n        </span>\n      );\n    }\n\n    if (filteredSkills.english && staff.skills.english === 'daily_conversation') {\n      badges.push(\n        <span key=\"english\" className=\"e-skill-badge e-skill-badge--english\">\n          英語可\n        </span>\n      );\n    }\n\n    if (filteredSkills.eventExperience && staff.skills.eventExperience) {\n      badges.push(\n        <span key=\"exp\" className=\"e-skill-badge e-skill-badge--exp\">\n          経験あり\n        </span>\n      );\n    }\n\n    return badges.length > 0 ? <div className=\"e-skills\">{badges}</div> : null;\n  };\n\n  return (\n    <StyledStaffList>\n      {staffList.length === 0 ? (\n        <li className=\"e-empty\">スタッフがいません</li>\n      ) : (\n        staffList.map((staff) => {\n          const detailUrl = buildDetailUrl(staff.id);\n          return (\n            <li\n              key={staff.id}\n              className={`e-item ${selectedStaffId === staff.id ? \"is-selected\" : \"\"}`}\n            >\n              <ObjectView\n                type=\"Staff\"\n                url={detailUrl}\n                label={staff.name}\n                draggable={true}\n                onClick={() => onStaffClick?.(staff.id)}\n              >\n                <div className=\"e-content\">\n                  <PersonIcon fontSize=\"small\" className=\"e-avatar\" />\n                  <div className=\"e-text\">\n                    <div className=\"e-name\">{staff.name}</div>\n                    <div className=\"e-meta\">\n                      {staff.state.school} / {staff.state.grade}\n                    </div>\n                    {renderSkillBadges(staff)}\n                  </div>\n                </div>\n              </ObjectView>\n            </li>\n          );\n        })\n      )}\n    </StyledStaffList>\n  );\n};\n\nconst StyledStaffList = styled.ul`\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  max-height: 400px;\n  overflow-y: auto;\n\n  > .e-empty {\n    padding: 16px;\n    text-align: center;\n    color: #666;\n  }\n\n  > .e-item {\n    padding: 8px 12px;\n    border-bottom: 1px solid #eee;\n    cursor: pointer;\n    transition: background-color 0.15s;\n\n    &:hover {\n      background-color: #f5f5f5;\n    }\n\n    &.is-selected {\n      background-color: #e3f2fd;\n    }\n\n    &:last-child {\n      border-bottom: none;\n    }\n\n    > .e-content {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n\n    .e-avatar {\n      color: #666;\n      flex-shrink: 0;\n    }\n\n    .e-text {\n      flex: 1;\n      min-width: 0;\n    }\n\n    .e-name {\n      font-weight: bold;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    .e-meta {\n      color: #666;\n      font-size: 0.85em;\n    }\n\n    .e-skills {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 4px;\n      margin-top: 4px;\n    }\n\n    .e-skill-badge {\n      display: inline-block;\n      padding: 2px 6px;\n      border-radius: 4px;\n      font-size: 0.7em;\n      font-weight: bold;\n\n      &.e-skill-badge--pc {\n        background-color: #e3f2fd;\n        color: #1565c0;\n      }\n\n      &.e-skill-badge--zoom {\n        background-color: #f3e5f5;\n        color: #7b1fa2;\n      }\n\n      &.e-skill-badge--english {\n        background-color: #e8f5e9;\n        color: #2e7d32;\n      }\n\n      &.e-skill-badge--exp {\n        background-color: #fff3e0;\n        color: #e65100;\n      }\n    }\n  }\n`;\n","/**\n * サンプルスタッフデータ\n */\n\nimport { Staff_スタッフ, TimeSlot_時間帯 } from \"../domain\";\n\nconst timeSlots = TimeSlot_時間帯.createDefaultTimeSlots();\nconst allSlotIds = timeSlots.map((s) => s.id);\n\nexport function createSampleStaffList(): Staff_スタッフ[] {\n  return [\n    Staff_スタッフ.create({\n      name: \"田中 太郎\",\n      furigana: \"たなか たろう\",\n      email: \"tanaka@example.com\",\n      phone: \"090-1234-5678\",\n      school: \"東京大学\",\n      grade: \"修士1年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"advanced\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"学園祭実行委員2年\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-20\", period: \"afternoon\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-20_afternoon\"),\n      notes: \"リーダー経験あり\",\n    }),\n    Staff_スタッフ.create({\n      name: \"佐藤 花子\",\n      furigana: \"さとう はなこ\",\n      email: \"sato@example.com\",\n      phone: \"090-2345-6789\",\n      school: \"早稲田大学\",\n      grade: \"学部3年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(2),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"鈴木 健太\",\n      furigana: \"すずき けんた\",\n      email: \"suzuki@example.com\",\n      phone: \"090-3456-7890\",\n      school: \"慶應義塾大学\",\n      grade: \"学部4年\",\n      gender: \"male\",\n      skills: {\n        pc: \"beginner\",\n        zoom: \"beginner\",\n        english: \"none\",\n        eventExperience: true,\n        eventExperienceDetail: \"部活の運営\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"体力に自信あり\",\n    }),\n    Staff_スタッフ.create({\n      name: \"高橋 美咲\",\n      furigana: \"たかはし みさき\",\n      email: \"takahashi@example.com\",\n      phone: \"090-4567-8901\",\n      school: \"東京工業大学\",\n      grade: \"修士2年\",\n      gender: \"female\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"国際学会ボランティア\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [\n          { date: \"2025-03-19\", period: \"morning\" },\n          { date: \"2025-03-21\", period: \"afternoon\" },\n        ],\n      },\n      availableTimeSlots: allSlotIds.filter(\n        (id) => id !== \"2025-03-19_morning\" && id !== \"2025-03-21_afternoon\"\n      ),\n      notes: \"英語対応可能\",\n    }),\n    Staff_スタッフ.create({\n      name: \"伊藤 大輔\",\n      furigana: \"いとう だいすけ\",\n      email: \"ito@example.com\",\n      phone: \"090-5678-9012\",\n      school: \"一橋大学\",\n      grade: \"学部2年\",\n      gender: \"male\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"none\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(5, 12),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"渡辺 さくら\",\n      furigana: \"わたなべ さくら\",\n      email: \"watanabe@example.com\",\n      phone: \"090-6789-0123\",\n      school: \"お茶の水女子大学\",\n      grade: \"学部4年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"オープンキャンパススタッフ\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"コミュニケーション能力高い\",\n    }),\n    Staff_スタッフ.create({\n      name: \"山本 翔太\",\n      furigana: \"やまもと しょうた\",\n      email: \"yamamoto@example.com\",\n      phone: \"090-7890-1234\",\n      school: \"東京大学\",\n      grade: \"博士1年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"advanced\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"学会運営経験3回\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-20\", period: \"morning\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-20_morning\"),\n      notes: \"過去に年会本部経験あり\",\n    }),\n    Staff_スタッフ.create({\n      name: \"中村 愛\",\n      furigana: \"なかむら あい\",\n      email: \"nakamura@example.com\",\n      phone: \"090-8901-2345\",\n      school: \"明治大学\",\n      grade: \"学部3年\",\n      gender: \"female\",\n      skills: {\n        pc: \"beginner\",\n        zoom: \"beginner\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(2, 10),\n      notes: \"懇親会参加可能\",\n    }),\n    // ここから追加スタッフ\n    Staff_スタッフ.create({\n      name: \"小林 誠\",\n      furigana: \"こばやし まこと\",\n      email: \"kobayashi@example.com\",\n      phone: \"090-1111-2222\",\n      school: \"京都大学\",\n      grade: \"修士1年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"研究室セミナー運営\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-19\", period: \"afternoon\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-19_afternoon\"),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"加藤 優子\",\n      furigana: \"かとう ゆうこ\",\n      email: \"kato@example.com\",\n      phone: \"090-2222-3333\",\n      school: \"上智大学\",\n      grade: \"学部2年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"留学経験あり\",\n    }),\n    Staff_スタッフ.create({\n      name: \"吉田 拓也\",\n      furigana: \"よしだ たくや\",\n      email: \"yoshida@example.com\",\n      phone: \"090-3333-4444\",\n      school: \"東北大学\",\n      grade: \"博士2年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"advanced\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"国際会議運営補佐\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-21\", period: \"morning\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-21_morning\"),\n      notes: \"複数言語対応可\",\n    }),\n    Staff_スタッフ.create({\n      name: \"山田 真由\",\n      furigana: \"やまだ まゆ\",\n      email: \"yamada@example.com\",\n      phone: \"090-4444-5555\",\n      school: \"日本女子大学\",\n      grade: \"学部4年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"beginner\",\n        english: \"none\",\n        eventExperience: true,\n        eventExperienceDetail: \"サークル会計\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(0, 8),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"松本 健一\",\n      furigana: \"まつもと けんいち\",\n      email: \"matsumoto@example.com\",\n      phone: \"090-5555-6666\",\n      school: \"九州大学\",\n      grade: \"修士2年\",\n      gender: \"male\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-20\", period: \"afternoon\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-20_afternoon\"),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"井上 さやか\",\n      furigana: \"いのうえ さやか\",\n      email: \"inoue@example.com\",\n      phone: \"090-6666-7777\",\n      school: \"立教大学\",\n      grade: \"学部3年\",\n      gender: \"female\",\n      skills: {\n        pc: \"beginner\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"ボランティア活動\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"明るい性格\",\n    }),\n    Staff_スタッフ.create({\n      name: \"木村 雄大\",\n      furigana: \"きむら ゆうだい\",\n      email: \"kimura@example.com\",\n      phone: \"090-7777-8888\",\n      school: \"名古屋大学\",\n      grade: \"学部1年\",\n      gender: \"male\",\n      skills: {\n        pc: \"beginner\",\n        zoom: \"none\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(4),\n      notes: \"力仕事可能\",\n    }),\n    Staff_スタッフ.create({\n      name: \"林 美穂\",\n      furigana: \"はやし みほ\",\n      email: \"hayashi@example.com\",\n      phone: \"090-8888-9999\",\n      school: \"神戸大学\",\n      grade: \"修士1年\",\n      gender: \"female\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"advanced\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"学会発表多数\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-19\", period: \"morning\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-19_morning\"),\n      notes: \"リーダーシップあり\",\n    }),\n    Staff_スタッフ.create({\n      name: \"清水 大地\",\n      furigana: \"しみず だいち\",\n      email: \"shimizu@example.com\",\n      phone: \"090-9999-0000\",\n      school: \"北海道大学\",\n      grade: \"学部3年\",\n      gender: \"male\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"beginner\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(2, 12),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"森 彩香\",\n      furigana: \"もり あやか\",\n      email: \"mori@example.com\",\n      phone: \"090-0000-1111\",\n      school: \"津田塾大学\",\n      grade: \"学部2年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"池田 航\",\n      furigana: \"いけだ わたる\",\n      email: \"ikeda@example.com\",\n      phone: \"090-1212-3434\",\n      school: \"大阪大学\",\n      grade: \"博士1年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"advanced\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"国際シンポジウム運営\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [\n          { date: \"2025-03-20\", period: \"morning\" },\n          { date: \"2025-03-21\", period: \"afternoon\" },\n        ],\n      },\n      availableTimeSlots: allSlotIds.filter(\n        (id) => id !== \"2025-03-20_morning\" && id !== \"2025-03-21_afternoon\"\n      ),\n      notes: \"英語堪能\",\n    }),\n    Staff_スタッフ.create({\n      name: \"橋本 萌\",\n      furigana: \"はしもと もえ\",\n      email: \"hashimoto@example.com\",\n      phone: \"090-2323-4545\",\n      school: \"青山学院大学\",\n      grade: \"学部4年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"none\",\n        eventExperience: true,\n        eventExperienceDetail: \"イベント企画サークル\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(0, 10),\n      notes: \"企画力あり\",\n    }),\n    Staff_スタッフ.create({\n      name: \"山口 隆\",\n      furigana: \"やまぐち たかし\",\n      email: \"yamaguchi@example.com\",\n      phone: \"090-3434-5656\",\n      school: \"筑波大学\",\n      grade: \"修士2年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"研究会幹事\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-21\", period: \"morning\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-21_morning\"),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"石川 結衣\",\n      furigana: \"いしかわ ゆい\",\n      email: \"ishikawa@example.com\",\n      phone: \"090-4545-6767\",\n      school: \"東京女子大学\",\n      grade: \"学部3年\",\n      gender: \"female\",\n      skills: {\n        pc: \"beginner\",\n        zoom: \"beginner\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(4, 14),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"前田 悠斗\",\n      furigana: \"まえだ ゆうと\",\n      email: \"maeda@example.com\",\n      phone: \"090-5656-7878\",\n      school: \"横浜国立大学\",\n      grade: \"学部2年\",\n      gender: \"male\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"none\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"体育会系\",\n    }),\n    Staff_スタッフ.create({\n      name: \"藤田 菜々子\",\n      furigana: \"ふじた ななこ\",\n      email: \"fujita@example.com\",\n      phone: \"090-6767-8989\",\n      school: \"学習院大学\",\n      grade: \"学部4年\",\n      gender: \"female\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"留学生サポーター\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(2),\n      notes: \"外国語対応可\",\n    }),\n    Staff_スタッフ.create({\n      name: \"岡田 智也\",\n      furigana: \"おかだ ともや\",\n      email: \"okada@example.com\",\n      phone: \"090-7878-9090\",\n      school: \"千葉大学\",\n      grade: \"修士1年\",\n      gender: \"male\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"advanced\",\n        english: \"none\",\n        eventExperience: true,\n        eventExperienceDetail: \"学内IT支援\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds,\n      notes: \"ITに強い\",\n    }),\n    Staff_スタッフ.create({\n      name: \"後藤 美月\",\n      furigana: \"ごとう みづき\",\n      email: \"goto@example.com\",\n      phone: \"090-8989-0101\",\n      school: \"フェリス女学院大学\",\n      grade: \"学部1年\",\n      gender: \"female\",\n      skills: {\n        pc: \"beginner\",\n        zoom: \"beginner\",\n        english: \"daily_conversation\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(6),\n      notes: \"初参加\",\n    }),\n    Staff_スタッフ.create({\n      name: \"長谷川 颯太\",\n      furigana: \"はせがわ そうた\",\n      email: \"hasegawa@example.com\",\n      phone: \"090-0101-2323\",\n      school: \"広島大学\",\n      grade: \"学部3年\",\n      gender: \"male\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"intermediate\",\n        english: \"none\",\n        eventExperience: true,\n        eventExperienceDetail: \"学園祭実行委員\",\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(0, 12),\n      notes: \"\",\n    }),\n    Staff_スタッフ.create({\n      name: \"村上 真帆\",\n      furigana: \"むらかみ まほ\",\n      email: \"murakami@example.com\",\n      phone: \"090-1313-2424\",\n      school: \"同志社大学\",\n      grade: \"修士2年\",\n      gender: \"female\",\n      skills: {\n        pc: \"advanced\",\n        zoom: \"intermediate\",\n        english: \"daily_conversation\",\n        eventExperience: true,\n        eventExperienceDetail: \"学会幹事経験\",\n      },\n      presentation: {\n        hasPresentation: true,\n        presentations: [{ date: \"2025-03-19\", period: \"afternoon\" }],\n      },\n      availableTimeSlots: allSlotIds.filter((id) => id !== \"2025-03-19_afternoon\"),\n      notes: \"経験豊富\",\n    }),\n    Staff_スタッフ.create({\n      name: \"近藤 亮\",\n      furigana: \"こんどう りょう\",\n      email: \"kondo@example.com\",\n      phone: \"090-2424-3535\",\n      school: \"東京理科大学\",\n      grade: \"学部2年\",\n      gender: \"male\",\n      skills: {\n        pc: \"intermediate\",\n        zoom: \"beginner\",\n        english: \"none\",\n        eventExperience: false,\n      },\n      presentation: {\n        hasPresentation: false,\n        presentations: [],\n      },\n      availableTimeSlots: allSlotIds.slice(4, 14),\n      notes: \"\",\n    }),\n  ];\n}\n","'use client';\n\nimport { FC, useEffect, useMemo, useContext } from \"react\";\nimport { useAppDispatch, useAppSelector } from \"@bublys-org/state-management\";\nimport {\n  selectGakkaiShiftStaffList,\n  selectGakkaiShiftSelectedStaffId,\n  setStaffList,\n  setSelectedStaffId,\n} from \"../slice/index.js\";\nimport { StaffListView } from \"../ui/StaffListView.js\";\nimport { createSampleStaffList } from \"../data/sampleStaff.js\";\nimport { Staff_スタッフ, SkillLevel_スキルレベル, TimeSlot_時間帯, Role_係 } from \"../domain/index.js\";\nimport styled from \"styled-components\";\nimport { Button } from \"@mui/material\";\nimport FilterListIcon from \"@mui/icons-material/FilterList\";\nimport { BubblesContext } from \"@bublys-org/bubbles-ui\";\n\n/** フィルター条件の型 */\nexport type StaffFilterCriteria = {\n  pc?: { level: SkillLevel_スキルレベル; operator: '>=' | '=' };\n  zoom?: { level: SkillLevel_スキルレベル; operator: '>=' | '=' };\n  english?: boolean;\n  eventExperience?: boolean;\n  availableAt?: string[];  // 参加可能な時間帯のID配列（AND条件）\n};\n\n/** URLクエリからフィルターをパース */\nexport function parseStaffFilter(query: string): StaffFilterCriteria {\n  const filter: StaffFilterCriteria = {};\n  if (!query) return filter;\n\n  const params = new URLSearchParams(query);\n\n  // pc=intermediate+ → { level: 'intermediate', operator: '>=' }\n  const pc = params.get('pc');\n  if (pc) {\n    if (pc.endsWith('+')) {\n      filter.pc = { level: pc.slice(0, -1) as SkillLevel_スキルレベル, operator: '>=' };\n    } else {\n      filter.pc = { level: pc as SkillLevel_スキルレベル, operator: '=' };\n    }\n  }\n\n  const zoom = params.get('zoom');\n  if (zoom) {\n    if (zoom.endsWith('+')) {\n      filter.zoom = { level: zoom.slice(0, -1) as SkillLevel_スキルレベル, operator: '>=' };\n    } else {\n      filter.zoom = { level: zoom as SkillLevel_スキルレベル, operator: '=' };\n    }\n  }\n\n  if (params.get('english') === 'yes') {\n    filter.english = true;\n  }\n\n  if (params.get('eventExperience') === 'yes') {\n    filter.eventExperience = true;\n  }\n\n  // availableAt=slot1,slot2,slot3 → ['slot1', 'slot2', 'slot3']\n  const availableAt = params.get('availableAt');\n  if (availableAt) {\n    filter.availableAt = availableAt.split(',');\n  }\n\n  return filter;\n}\n\n/** フィルターをURL文字列に変換 */\nexport function stringifyStaffFilter(filter: StaffFilterCriteria): string {\n  const params = new URLSearchParams();\n\n  if (filter.pc) {\n    params.set('pc', filter.pc.level + (filter.pc.operator === '>=' ? '+' : ''));\n  }\n  if (filter.zoom) {\n    params.set('zoom', filter.zoom.level + (filter.zoom.operator === '>=' ? '+' : ''));\n  }\n  if (filter.english) {\n    params.set('english', 'yes');\n  }\n  if (filter.eventExperience) {\n    params.set('eventExperience', 'yes');\n  }\n  if (filter.availableAt && filter.availableAt.length > 0) {\n    params.set('availableAt', filter.availableAt.join(','));\n  }\n\n  const str = params.toString();\n  return str ? `?${str}` : '';\n}\n\n/** @deprecated Use parseStaffFilter instead */\nexport const parseStaffFilterCriteria = parseStaffFilter;\n\n/** @deprecated Use stringifyStaffFilter instead */\nexport const stringifyStaffFilterCriteria = stringifyStaffFilter;\n\n/** スキルレベルを比較 */\nfunction matchesSkillFilter(\n  staffLevel: SkillLevel_スキルレベル,\n  filterLevel: SkillLevel_スキルレベル,\n  operator: '>=' | '='\n): boolean {\n  if (operator === '=') {\n    return staffLevel === filterLevel;\n  }\n  // >= の場合\n  const staffNum = Role_係.skillLevelToNumber(staffLevel);\n  const filterNum = Role_係.skillLevelToNumber(filterLevel);\n  return staffNum >= filterNum;\n}\n\n/** フィルター条件にマッチするか判定 */\nfunction matchesFilter(staff: Staff_スタッフ, filter: StaffFilterCriteria): boolean {\n  if (filter.pc && !matchesSkillFilter(staff.skills.pc, filter.pc.level, filter.pc.operator)) {\n    return false;\n  }\n  if (filter.zoom && !matchesSkillFilter(staff.skills.zoom, filter.zoom.level, filter.zoom.operator)) {\n    return false;\n  }\n  if (filter.english && staff.skills.english !== 'daily_conversation') {\n    return false;\n  }\n  if (filter.eventExperience && !staff.skills.eventExperience) {\n    return false;\n  }\n  // 参加可能時間帯のAND条件チェック（すべての指定時間帯に参加可能である必要がある）\n  if (filter.availableAt && filter.availableAt.length > 0) {\n    const allAvailable = filter.availableAt.every((slotId) => staff.isAvailableAt(slotId));\n    if (!allAvailable) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/** フィルター条件を人間が読める形式で説明（スキルと時間帯を分けて返す） */\nfunction describeFilter(filter: StaffFilterCriteria): { skills: string; timeSlots: string } {\n  const skillParts: string[] = [];\n  let timeSlotsPart = '';\n\n  if (filter.pc) {\n    const levelLabel = Role_係.getSkillLevelLabel(filter.pc.level);\n    const opLabel = filter.pc.operator === '>=' ? '以上' : '';\n    skillParts.push(`PC${levelLabel}${opLabel}`);\n  }\n\n  if (filter.zoom) {\n    const levelLabel = Role_係.getSkillLevelLabel(filter.zoom.level);\n    const opLabel = filter.zoom.operator === '>=' ? '以上' : '';\n    skillParts.push(`Zoom${levelLabel}${opLabel}`);\n  }\n\n  if (filter.english) {\n    skillParts.push('英語可');\n  }\n\n  if (filter.eventExperience) {\n    skillParts.push('経験あり');\n  }\n\n  if (filter.availableAt && filter.availableAt.length > 0) {\n    const timeSlots = TimeSlot_時間帯.createDefaultTimeSlots();\n    const slotLabels = filter.availableAt.map((slotId) => {\n      const slot = timeSlots.find((s) => s.id === slotId);\n      if (!slot) return slotId;\n      const date = new Date(slot.date);\n      const month = date.getMonth() + 1;\n      const day = date.getDate();\n      const period = TimeSlot_時間帯.getPeriodLabel(slot.period);\n      return `${month}/${day}${period}`;\n    });\n    timeSlotsPart = `${slotLabels.join('・')}参加可能`;\n  }\n\n  return { skills: skillParts.join('、'), timeSlots: timeSlotsPart };\n}\n\ntype StaffCollectionProps = {\n  filter?: StaffFilterCriteria;\n  onStaffSelect?: (staffId: string) => void;\n};\n\nconst buildDetailUrl = (staffId: string) => `gakkai-shift/staffs/${staffId}`;\n\nexport const StaffCollection: FC<StaffCollectionProps> = ({ filter, onStaffSelect }) => {\n  const dispatch = useAppDispatch();\n  const staffList = useAppSelector(selectGakkaiShiftStaffList);\n  const selectedStaffId = useAppSelector(selectGakkaiShiftSelectedStaffId);\n  const { openBubble } = useContext(BubblesContext);\n\n  // 初期データのロード\n  useEffect(() => {\n    if (staffList.length === 0) {\n      const sampleData = createSampleStaffList();\n      dispatch(setStaffList(sampleData.map((s) => s.toJSON())));\n    }\n  }, [dispatch, staffList.length]);\n\n  // フィルター適用\n  const filteredStaffList = useMemo(() => {\n    if (!filter || Object.keys(filter).length === 0) {\n      return staffList;\n    }\n    return staffList.filter((staff) => matchesFilter(staff, filter));\n  }, [staffList, filter]);\n\n  const handleStaffClick = (staffId: string) => {\n    dispatch(setSelectedStaffId(staffId));\n    onStaffSelect?.(staffId);\n  };\n\n  const hasFilter = filter && Object.keys(filter).length > 0;\n  const filterDescription = hasFilter ? describeFilter(filter) : null;\n\n  // 絞り込み検索バブルを開く\n  const handleOpenFilter = () => {\n    // 現在のフィルター条件を引き継いで検索画面を開く\n    const currentFilter = filter ? stringifyStaffFilterCriteria(filter) : '';\n    openBubble(`gakkai-shift/staffs/filter${currentFilter}`, 'root');\n  };\n\n  return (\n    <StyledContainer>\n      <div className=\"e-header\">\n        {hasFilter && filterDescription ? (\n          <>\n            <div className=\"e-filter-description\">\n              {filterDescription.skills && (\n                <p>「{filterDescription.skills}」</p>\n              )}\n              {filterDescription.timeSlots && (\n                <p>「{filterDescription.timeSlots}」</p>\n              )}\n              <p>な</p>\n            </div>\n            <h3>\n              スタッフ一覧\n              <span className=\"e-filter-badge\">\n                ({filteredStaffList.length}/{staffList.length}名)\n              </span>\n            </h3>\n          </>\n        ) : (\n          <h3>スタッフ一覧 ({staffList.length}名)</h3>\n        )}\n      </div>\n\n      {/* 絞り込み検索ボタン */}\n      <div className=\"e-filter-section\">\n        <Button\n          variant=\"outlined\"\n          size=\"small\"\n          startIcon={<FilterListIcon />}\n          onClick={handleOpenFilter}\n          className=\"e-filter-button\"\n        >\n          絞り込み検索\n        </Button>\n      </div>\n\n      <StaffListView\n        staffList={filteredStaffList}\n        selectedStaffId={selectedStaffId}\n        buildDetailUrl={buildDetailUrl}\n        onStaffClick={handleStaffClick}\n        filteredSkills={hasFilter ? {\n          pc: filter.pc,\n          zoom: filter.zoom,\n          english: filter.english,\n          eventExperience: filter.eventExperience,\n        } : undefined}\n      />\n    </StyledContainer>\n  );\n};\n\nconst StyledContainer = styled.div`\n  .e-header {\n    margin-bottom: 8px;\n\n    h3 {\n      margin: 0;\n    }\n\n    .e-filter-description {\n      margin: 0 0 4px 0;\n      font-size: 0.85em;\n      color: #1976d2;\n\n      p {\n        margin: 0;\n      }\n    }\n\n    .e-filter-badge {\n      font-weight: normal;\n      color: #1976d2;\n    }\n  }\n\n  .e-filter-section {\n    margin-bottom: 12px;\n\n    .e-filter-button {\n      font-size: 0.85em;\n      text-transform: none;\n    }\n  }\n`;\n","'use client';\n\nimport { FC, useState, useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { Button, ToggleButton, ToggleButtonGroup, Checkbox, FormControlLabel } from \"@mui/material\";\nimport SearchIcon from \"@mui/icons-material/Search\";\nimport { BubblesContext } from \"@bublys-org/bubbles-ui\";\nimport { TimeSlot_時間帯 } from \"../domain/index.js\";\nimport { StaffFilterCriteria as StaffFilterType, stringifyStaffFilter } from \"./StaffCollection.js\";\n\ntype StaffFilterProps = {\n  // 初期フィルター（URLから復元した場合など）\n  initialFilter?: StaffFilterType;\n};\n\nexport const StaffFilter: FC<StaffFilterProps> = ({ initialFilter }) => {\n  const { openBubble } = useContext(BubblesContext);\n  const timeSlots = TimeSlot_時間帯.createDefaultTimeSlots();\n\n  // スキルフィルターの選択状態\n  const getInitialSkillFilters = (): string[] => {\n    const selected: string[] = [];\n    if (initialFilter?.pc) selected.push('pc');\n    if (initialFilter?.zoom) selected.push('zoom');\n    if (initialFilter?.english) selected.push('english');\n    if (initialFilter?.eventExperience) selected.push('eventExperience');\n    return selected;\n  };\n\n  const [selectedSkills, setSelectedSkills] = useState<string[]>(getInitialSkillFilters);\n\n  // 時間帯フィルターの選択状態\n  const [selectedTimeSlots, setSelectedTimeSlots] = useState<string[]>(\n    initialFilter?.availableAt ?? []\n  );\n\n  const handleSkillToggle = (_event: React.MouseEvent<HTMLElement>, newSkills: string[]) => {\n    setSelectedSkills(newSkills);\n  };\n\n  const handleTimeSlotToggle = (slotId: string) => {\n    setSelectedTimeSlots((prev) =>\n      prev.includes(slotId)\n        ? prev.filter((id) => id !== slotId)\n        : [...prev, slotId]\n    );\n  };\n\n  // 日付ごとに「全選択」\n  const handleSelectDate = (date: string) => {\n    const slotsForDate = timeSlots.filter((s) => s.date === date).map((s) => s.id);\n    const allSelected = slotsForDate.every((id) => selectedTimeSlots.includes(id));\n\n    if (allSelected) {\n      // 全解除\n      setSelectedTimeSlots((prev) => prev.filter((id) => !slotsForDate.includes(id)));\n    } else {\n      // 全選択\n      setSelectedTimeSlots((prev) => [...new Set([...prev, ...slotsForDate])]);\n    }\n  };\n\n  // 検索ボタンクリック\n  const handleSearch = () => {\n    const filter: StaffFilterType = {};\n\n    if (selectedSkills.includes('pc')) {\n      filter.pc = { level: 'intermediate', operator: '>=' };\n    }\n    if (selectedSkills.includes('zoom')) {\n      filter.zoom = { level: 'intermediate', operator: '>=' };\n    }\n    if (selectedSkills.includes('english')) {\n      filter.english = true;\n    }\n    if (selectedSkills.includes('eventExperience')) {\n      filter.eventExperience = true;\n    }\n    if (selectedTimeSlots.length > 0) {\n      filter.availableAt = selectedTimeSlots;\n    }\n\n    const query = stringifyStaffFilter(filter);\n    openBubble(`gakkai-shift/staffs${query}`, 'root');\n  };\n\n  const hasSelection = selectedSkills.length > 0 || selectedTimeSlots.length > 0;\n\n  // 日付ごとにグループ化\n  const slotsByDate = timeSlots.reduce((acc, slot) => {\n    if (!acc[slot.date]) {\n      acc[slot.date] = [];\n    }\n    acc[slot.date].push(slot);\n    return acc;\n  }, {} as Record<string, TimeSlot_時間帯[]>);\n\n  const dates = Object.keys(slotsByDate).sort();\n\n  const formatDate = (dateStr: string): string => {\n    const date = new Date(dateStr);\n    const month = date.getMonth() + 1;\n    const day = date.getDate();\n    const weekdays = ['日', '月', '火', '水', '木', '金', '土'];\n    const weekday = weekdays[date.getDay()];\n    return `${month}/${day}(${weekday})`;\n  };\n\n  return (\n    <StyledContainer>\n      <h3>スタッフ絞り込み検索</h3>\n\n      {/* スキルフィルター */}\n      <section className=\"e-section\">\n        <h4>スキル条件</h4>\n        <ToggleButtonGroup\n          value={selectedSkills}\n          onChange={handleSkillToggle}\n          size=\"small\"\n          className=\"e-skill-toggles\"\n        >\n          <ToggleButton value=\"pc\">PC中級+</ToggleButton>\n          <ToggleButton value=\"zoom\">Zoom中級+</ToggleButton>\n          <ToggleButton value=\"english\">英語可</ToggleButton>\n          <ToggleButton value=\"eventExperience\">経験あり</ToggleButton>\n        </ToggleButtonGroup>\n      </section>\n\n      {/* 参加可能日程フィルター */}\n      <section className=\"e-section\">\n        <h4>参加可能日程（AND条件）</h4>\n        <p className=\"e-hint\">選択した全ての時間帯に参加可能なスタッフを検索</p>\n        <div className=\"e-timeslots\">\n          {dates.map((date) => {\n            const slots = slotsByDate[date];\n            const allSelected = slots.every((s) => selectedTimeSlots.includes(s.id));\n            const someSelected = slots.some((s) => selectedTimeSlots.includes(s.id));\n\n            return (\n              <div key={date} className=\"e-date-group\">\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      checked={allSelected}\n                      indeterminate={someSelected && !allSelected}\n                      onChange={() => handleSelectDate(date)}\n                      size=\"small\"\n                    />\n                  }\n                  label={<span className=\"e-date-label\">{formatDate(date)}</span>}\n                  className=\"e-date-header\"\n                />\n                <div className=\"e-slots\">\n                  {slots.map((slot) => (\n                    <FormControlLabel\n                      key={slot.id}\n                      control={\n                        <Checkbox\n                          checked={selectedTimeSlots.includes(slot.id)}\n                          onChange={() => handleTimeSlotToggle(slot.id)}\n                          size=\"small\"\n                        />\n                      }\n                      label={\n                        <span className={slot.isOrientation ? 'e-orientation' : ''}>\n                          {TimeSlot_時間帯.getPeriodLabel(slot.period)}\n                          {slot.isOrientation && ' (オリエン)'}\n                        </span>\n                      }\n                      className=\"e-slot-item\"\n                    />\n                  ))}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </section>\n\n      {/* 検索ボタン */}\n      <div className=\"e-actions\">\n        <Button\n          variant=\"contained\"\n          size=\"large\"\n          startIcon={<SearchIcon />}\n          onClick={handleSearch}\n          disabled={!hasSelection}\n          fullWidth\n        >\n          検索\n        </Button>\n      </div>\n    </StyledContainer>\n  );\n};\n\nconst StyledContainer = styled.div`\n  padding: 16px;\n\n  h3 {\n    margin: 0 0 16px 0;\n  }\n\n  .e-section {\n    margin-bottom: 20px;\n\n    h4 {\n      margin: 0 0 8px 0;\n      font-size: 0.9em;\n      color: #333;\n    }\n\n    .e-hint {\n      margin: 0 0 8px 0;\n      font-size: 0.8em;\n      color: #666;\n    }\n  }\n\n  .e-skill-toggles {\n    flex-wrap: wrap;\n\n    .MuiToggleButton-root {\n      font-size: 0.8em;\n      padding: 6px 12px;\n      text-transform: none;\n\n      &.Mui-selected {\n        background-color: #1976d2;\n        color: white;\n\n        &:hover {\n          background-color: #1565c0;\n        }\n      }\n    }\n  }\n\n  .e-timeslots {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n  }\n\n  .e-date-group {\n    padding: 8px;\n    background-color: #f5f5f5;\n    border-radius: 4px;\n\n    .e-date-header {\n      margin: 0;\n\n      .e-date-label {\n        font-weight: bold;\n        font-size: 0.9em;\n      }\n    }\n\n    .e-slots {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 4px;\n      margin-left: 24px;\n      margin-top: 4px;\n    }\n\n    .e-slot-item {\n      margin: 0;\n\n      .MuiFormControlLabel-label {\n        font-size: 0.8em;\n      }\n\n      .e-orientation {\n        color: #e65100;\n      }\n    }\n  }\n\n  .e-actions {\n    margin-top: 20px;\n\n    button {\n      text-transform: none;\n      font-size: 1em;\n    }\n  }\n`;\n","'use client';\n\nimport { FC } from \"react\";\nimport styled from \"styled-components\";\nimport { Staff_スタッフ, Role_係 } from \"../domain/index.js\";\nimport PersonIcon from \"@mui/icons-material/Person\";\nimport { ObjectView } from \"@bublys-org/bubbles-ui\";\nimport { Button } from \"@mui/material\";\n\ntype StaffDetailViewProps = {\n  staff: Staff_スタッフ;\n  buildAvailabilityUrl?: (staffId: string) => string;\n  onOpenAvailability?: (staffId: string) => void;\n};\n\nexport const StaffDetailView: FC<StaffDetailViewProps> = ({\n  staff,\n  buildAvailabilityUrl,\n  onOpenAvailability,\n}) => {\n  const availabilityUrl = buildAvailabilityUrl?.(staff.id);\n\n  return (\n    <StyledStaffDetail>\n      <div className=\"e-header\">\n        <PersonIcon className=\"e-avatar\" />\n        <div className=\"e-title\">\n          <ObjectView\n            type=\"Staff\"\n            url={`gakkai-shift/staffs/${staff.id}`}\n            label={staff.name}\n            draggable={true}\n          >\n            <h3 className=\"e-name\">{staff.name}</h3>\n          </ObjectView>\n          <div className=\"e-furigana\">{staff.state.furigana}</div>\n        </div>\n        <StatusBadge status={staff.status} />\n      </div>\n\n      <section className=\"e-section\">\n        <h4>基本情報</h4>\n        <dl className=\"e-dl\">\n          <dt>所属</dt>\n          <dd>{staff.state.school}</dd>\n          <dt>学年</dt>\n          <dd>{staff.state.grade}</dd>\n          <dt>性別</dt>\n          <dd>{Staff_スタッフ.getGenderLabel(staff.gender)}</dd>\n          <dt>メール</dt>\n          <dd>{staff.email}</dd>\n          <dt>電話</dt>\n          <dd>{staff.state.phone}</dd>\n        </dl>\n      </section>\n\n      <section className=\"e-section\">\n        <h4>スキル</h4>\n        <dl className=\"e-dl\">\n          <dt>PC</dt>\n          <dd>{Role_係.getSkillLevelLabel(staff.skills.pc)}</dd>\n          <dt>Zoom</dt>\n          <dd>{Role_係.getSkillLevelLabel(staff.skills.zoom)}</dd>\n          <dt>英語</dt>\n          <dd>{staff.skills.english === 'daily_conversation' ? '日常会話可' : 'なし'}</dd>\n          <dt>イベント経験</dt>\n          <dd>\n            {staff.skills.eventExperience ? 'あり' : 'なし'}\n            {staff.skills.eventExperienceDetail && (\n              <span className=\"e-detail\"> ({staff.skills.eventExperienceDetail})</span>\n            )}\n          </dd>\n        </dl>\n      </section>\n\n      <section className=\"e-section\">\n        <h4>参加可能時間帯</h4>\n        <div className=\"e-slots\">\n          {staff.availableTimeSlots.length === 0 ? (\n            <span className=\"e-empty\">なし</span>\n          ) : availabilityUrl ? (\n            <ObjectView\n              type=\"StaffAvailability\"\n              url={availabilityUrl}\n              label={`${staff.name}の参加可能時間帯`}\n              draggable={true}\n              onClick={() => onOpenAvailability?.(staff.id)}\n            >\n              <Button\n                variant=\"text\"\n                size=\"small\"\n                component=\"span\"\n              >\n                {staff.availableTimeSlots.length}枠 (詳細を見る)\n              </Button>\n            </ObjectView>\n          ) : (\n            <span>{staff.availableTimeSlots.length}枠</span>\n          )}\n        </div>\n      </section>\n\n      {staff.presentation.hasPresentation && (\n        <section className=\"e-section\">\n          <h4>発表予定</h4>\n          <ul className=\"e-presentations\">\n            {staff.presentation.presentations.map((p, i) => (\n              <li key={i}>{p.date} {p.period}</li>\n            ))}\n          </ul>\n        </section>\n      )}\n\n      {staff.aptitudeScore !== undefined && (\n        <section className=\"e-section\">\n          <h4>適性スコア</h4>\n          <div className=\"e-score\">{staff.aptitudeScore}点</div>\n        </section>\n      )}\n\n      {staff.state.notes && (\n        <section className=\"e-section\">\n          <h4>備考</h4>\n          <p className=\"e-notes\">{staff.state.notes}</p>\n        </section>\n      )}\n    </StyledStaffDetail>\n  );\n};\n\nconst StatusBadge: FC<{ status: string }> = ({ status }) => {\n  const label = Staff_スタッフ.getStatusLabel(status as 'pending' | 'accepted' | 'waitlist' | 'rejected');\n  return <span className={`e-badge e-badge--${status}`}>{label}</span>;\n};\n\nconst StyledStaffDetail = styled.div`\n  padding: 16px;\n\n  .e-header {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    margin-bottom: 16px;\n    padding-bottom: 16px;\n    border-bottom: 1px solid #eee;\n  }\n\n  .e-avatar {\n    font-size: 48px;\n    color: #666;\n  }\n\n  .e-title {\n    flex: 1;\n  }\n\n  .e-name {\n    margin: 0;\n    font-size: 1.25em;\n  }\n\n  .e-furigana {\n    color: #666;\n    font-size: 0.85em;\n  }\n\n  .e-badge {\n    display: inline-block;\n    padding: 4px 12px;\n    border-radius: 16px;\n    font-size: 0.85em;\n    font-weight: bold;\n\n    &.e-badge--pending {\n      background-color: #fff3e0;\n      color: #e65100;\n    }\n\n    &.e-badge--accepted {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n    }\n\n    &.e-badge--waitlist {\n      background-color: #e3f2fd;\n      color: #1565c0;\n    }\n\n    &.e-badge--rejected {\n      background-color: #fce4ec;\n      color: #c62828;\n    }\n  }\n\n  .e-section {\n    margin-bottom: 16px;\n\n    h4 {\n      margin: 0 0 8px 0;\n      font-size: 0.9em;\n      color: #666;\n      border-bottom: 1px solid #eee;\n      padding-bottom: 4px;\n    }\n  }\n\n  .e-dl {\n    display: grid;\n    grid-template-columns: auto 1fr;\n    gap: 4px 12px;\n    margin: 0;\n\n    dt {\n      color: #666;\n      font-size: 0.9em;\n    }\n\n    dd {\n      margin: 0;\n    }\n  }\n\n  .e-detail {\n    color: #666;\n    font-size: 0.9em;\n  }\n\n  .e-slots, .e-score {\n    font-weight: bold;\n  }\n\n  .e-empty {\n    color: #999;\n  }\n\n  .e-presentations {\n    margin: 0;\n    padding-left: 20px;\n  }\n\n  .e-notes {\n    margin: 0;\n    white-space: pre-wrap;\n    color: #333;\n  }\n`;\n","'use client';\n\nimport { FC } from \"react\";\nimport { useAppSelector } from \"@bublys-org/state-management\";\nimport {\n  selectGakkaiShiftSelectedStaff,\n  selectGakkaiShiftStaffById,\n} from \"../slice/index.js\";\nimport { StaffDetailView } from \"../ui/StaffDetailView.js\";\n\ntype StaffDetailProps = {\n  staffId?: string;\n  onOpenAvailability?: (staffId: string) => void;\n};\n\nconst buildAvailabilityUrl = (staffId: string) => `gakkai-shift/staffs/${staffId}/availableTimeSlots`;\n\nexport const StaffDetail: FC<StaffDetailProps> = ({ staffId, onOpenAvailability }) => {\n  // staffIdが指定されていればそれを使い、なければ選択中のスタッフを使う\n  const selectedStaff = useAppSelector(selectGakkaiShiftSelectedStaff);\n  const specificStaff = useAppSelector(\n    staffId ? selectGakkaiShiftStaffById(staffId) : () => undefined\n  );\n\n  const staff = staffId ? specificStaff : selectedStaff;\n\n  if (!staff) {\n    return (\n      <div style={{ padding: 16, color: \"#666\" }}>\n        スタッフを選択してください\n      </div>\n    );\n  }\n\n  return (\n    <StaffDetailView\n      staff={staff}\n      buildAvailabilityUrl={buildAvailabilityUrl}\n      onOpenAvailability={onOpenAvailability}\n    />\n  );\n};\n","'use client';\n\nimport { FC } from \"react\";\nimport styled from \"styled-components\";\nimport { Staff_スタッフ, TimeSlot_時間帯 } from \"../domain/index.js\";\nimport CheckIcon from \"@mui/icons-material/Check\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport { ObjectView } from \"@bublys-org/bubbles-ui\";\n\ntype StaffAvailabilityViewProps = {\n  staff: Staff_スタッフ;\n  timeSlots: TimeSlot_時間帯[];\n};\n\nexport const StaffAvailabilityView: FC<StaffAvailabilityViewProps> = ({\n  staff,\n  timeSlots,\n}) => {\n  // 日付ごとにグループ化\n  const slotsByDate = timeSlots.reduce((acc, slot) => {\n    const date = slot.date;\n    if (!acc[date]) {\n      acc[date] = [];\n    }\n    acc[date].push(slot);\n    return acc;\n  }, {} as Record<string, TimeSlot_時間帯[]>);\n\n  const dates = Object.keys(slotsByDate).sort();\n\n  return (\n    <StyledContainer>\n      <ObjectView\n        type=\"Staff\"\n        url={`gakkai-shift/staffs/${staff.id}`}\n        label={staff.name}\n        draggable={true}\n      >\n        <h3>{staff.name}</h3>\n      </ObjectView>\n      <p className=\"e-subtitle\">{staff.state.school} / {staff.state.grade}</p>\n\n      <div className=\"e-summary\">\n        参加可能: <strong>{staff.availableTimeSlots.length}</strong> / {timeSlots.length} 枠\n      </div>\n\n      <table className=\"e-table\">\n        <thead>\n          <tr>\n            <th>日付</th>\n            <th>時間帯</th>\n            <th>時間</th>\n            <th>参加可否</th>\n          </tr>\n        </thead>\n        <tbody>\n          {dates.map((date) =>\n            slotsByDate[date].map((slot, idx) => (\n              <tr key={slot.id} className={staff.isAvailableAt(slot.id) ? \"is-available\" : \"is-unavailable\"}>\n                {idx === 0 && (\n                  <td rowSpan={slotsByDate[date].length} className=\"e-date\">\n                    {formatDate(date)}\n                  </td>\n                )}\n                <td className=\"e-period\">\n                  {slot.label.split(' ')[1]}\n                  {slot.isOrientation && <span className=\"e-orientation\">オリエン</span>}\n                </td>\n                <td className=\"e-time\">\n                  {slot.state.startTime} - {slot.state.endTime}\n                </td>\n                <td className=\"e-status\">\n                  {staff.isAvailableAt(slot.id) ? (\n                    <span className=\"e-ok\"><CheckIcon fontSize=\"small\" /> 可能</span>\n                  ) : (\n                    <span className=\"e-ng\"><CloseIcon fontSize=\"small\" /> 不可</span>\n                  )}\n                </td>\n              </tr>\n            ))\n          )}\n        </tbody>\n      </table>\n    </StyledContainer>\n  );\n};\n\nconst formatDate = (dateStr: string): string => {\n  const date = new Date(dateStr);\n  const month = date.getMonth() + 1;\n  const day = date.getDate();\n  const weekdays = ['日', '月', '火', '水', '木', '金', '土'];\n  const weekday = weekdays[date.getDay()];\n  return `${month}/${day}(${weekday})`;\n};\n\nconst StyledContainer = styled.div`\n  h3 {\n    margin: 0 0 4px 0;\n  }\n\n  .e-subtitle {\n    margin: 0 0 12px 0;\n    color: #666;\n    font-size: 0.9em;\n  }\n\n  .e-summary {\n    margin-bottom: 16px;\n    padding: 8px 12px;\n    background-color: #f5f5f5;\n    border-radius: 4px;\n    font-size: 0.9em;\n  }\n\n  .e-table {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 0.85em;\n\n    th, td {\n      padding: 8px;\n      border: 1px solid #ddd;\n      text-align: left;\n    }\n\n    th {\n      background-color: #f0f0f0;\n      font-weight: bold;\n    }\n\n    .e-date {\n      font-weight: bold;\n      background-color: #fafafa;\n      vertical-align: top;\n    }\n\n    .e-period {\n      white-space: nowrap;\n    }\n\n    .e-orientation {\n      margin-left: 4px;\n      padding: 2px 4px;\n      background-color: #fff3e0;\n      color: #e65100;\n      font-size: 0.75em;\n      border-radius: 2px;\n    }\n\n    .e-time {\n      color: #666;\n      white-space: nowrap;\n    }\n\n    .e-status {\n      text-align: center;\n    }\n\n    .e-ok {\n      display: inline-flex;\n      align-items: center;\n      gap: 2px;\n      color: #2e7d32;\n    }\n\n    .e-ng {\n      display: inline-flex;\n      align-items: center;\n      gap: 2px;\n      color: #c62828;\n    }\n\n    tr.is-available {\n      background-color: #e8f5e9;\n    }\n\n    tr.is-unavailable {\n      background-color: #ffebee;\n    }\n  }\n`;\n","'use client';\n\nimport { FC, useMemo } from \"react\";\nimport { useAppSelector } from \"@bublys-org/state-management\";\nimport { selectGakkaiShiftStaffList } from \"../slice/index.js\";\nimport { StaffAvailabilityView } from \"../ui/StaffAvailabilityView.js\";\nimport { TimeSlot_時間帯 } from \"../domain/index.js\";\n\ntype StaffAvailabilityProps = {\n  staffId: string;\n};\n\nexport const StaffAvailability: FC<StaffAvailabilityProps> = ({ staffId }) => {\n  const staffList = useAppSelector(selectGakkaiShiftStaffList);\n  const staff = staffList.find((s) => s.id === staffId);\n\n  // デフォルトの時間帯を取得\n  const timeSlots = useMemo(() => TimeSlot_時間帯.createDefaultTimeSlots(), []);\n\n  if (!staff) {\n    return <div>スタッフが見つかりません</div>;\n  }\n\n  return <StaffAvailabilityView staff={staff} timeSlots={timeSlots} />;\n};\n","'use client';\n\nimport { FC } from \"react\";\nimport styled from \"styled-components\";\nimport {\n  TimeSlot_時間帯,\n  Role_係,\n  Staff_スタッフ,\n  ShiftAssignment_シフト配置,\n  ConstraintViolation,\n  StaffAssignmentEvaluation_スタッフ配置評価,\n} from \"../domain/index.js\";\nimport PersonIcon from \"@mui/icons-material/Person\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport WarningIcon from \"@mui/icons-material/Warning\";\nimport { IconButton, Tooltip } from \"@mui/material\";\nimport { ObjectView, getDragType, DRAG_KEYS } from \"@bublys-org/bubbles-ui\";\n\ntype ShiftPlanTableViewProps = {\n  timeSlots: readonly TimeSlot_時間帯[];\n  roles: readonly Role_係[];\n  assignments: readonly ShiftAssignment_シフト配置[];\n  staffList: readonly Staff_スタッフ[];\n  violations?: readonly ConstraintViolation[];\n  buildAssignmentUrl?: (assignmentId: string) => string;\n  /** セルクリック時に開くバブルのURLを生成（origin-side配置用） */\n  buildCellUrl?: (timeSlotId: string, roleId: string) => string;\n  onDropStaff?: (staffId: string, timeSlotId: string, roleId: string) => void;\n  onRemoveAssignment?: (assignmentId: string) => void;\n  onMoveAssignment?: (assignmentId: string, staffId: string, timeSlotId: string, roleId: string) => void;\n  onAssignmentClick?: (assignmentId: string) => void;\n  onCellClick?: (timeSlotId: string, roleId: string) => void;\n};\n\nexport const ShiftPlanTableView: FC<ShiftPlanTableViewProps> = ({\n  timeSlots,\n  roles,\n  assignments,\n  staffList,\n  violations = [],\n  buildAssignmentUrl,\n  buildCellUrl,\n  onDropStaff,\n  onRemoveAssignment,\n  onMoveAssignment,\n  onAssignmentClick,\n  onCellClick,\n}) => {\n  const getStaffName = (staffId: string): string => {\n    const staff = staffList.find((s) => s.id === staffId);\n    return staff?.name ?? \"不明\";\n  };\n\n  const getStaff = (staffId: string): Staff_スタッフ | undefined => {\n    return staffList.find((s) => s.id === staffId);\n  };\n\n  const getAssignmentsForCell = (timeSlotId: string, roleId: string) => {\n    return assignments.filter(\n      (a) => a.timeSlotId === timeSlotId && a.roleId === roleId\n    );\n  };\n\n  /** 配置が制約違反に含まれているかチェック */\n  const getViolationForAssignment = (assignmentId: string): ConstraintViolation | undefined => {\n    return violations.find((v) => v.assignmentIds.includes(assignmentId));\n  };\n\n  const calculateCellScore = (timeSlotId: string, roleId: string): number => {\n    const cellAssignments = getAssignmentsForCell(timeSlotId, roleId);\n    const role = roles.find((r) => r.id === roleId);\n    const timeSlot = timeSlots.find((t) => t.id === timeSlotId);\n    if (!role || !timeSlot) return 0;\n\n    let score = 0;\n    for (const assignment of cellAssignments) {\n      const staff = getStaff(assignment.staffId);\n      if (staff) {\n        // StaffAssignmentEvaluationで評価\n        const evaluation = StaffAssignmentEvaluation_スタッフ配置評価.evaluateCandidate(\n          staff,\n          role,\n          timeSlot\n        );\n        score += evaluation.totalScore;\n      }\n    }\n    return score;\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    // 内部のセル間移動またはObjectViewからのStaffドラッグを受け入れる\n    const types = Array.from(e.dataTransfer.types);\n    const staffDragType = getDragType(\"Staff\");\n    const isInternalMove = types.includes(\"text/staff-id\");\n    const isStaffDrag = types.includes(staffDragType);\n\n    console.log(\"[DragOver] types:\", types, \"staffDragType:\", staffDragType, \"isInternalMove:\", isInternalMove, \"isStaffDrag:\", isStaffDrag);\n\n    if (isInternalMove || isStaffDrag) {\n      e.preventDefault();\n      e.currentTarget.classList.add(\"is-drag-over\");\n    }\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.currentTarget.classList.remove(\"is-drag-over\");\n  };\n\n  const handleDrop = (e: React.DragEvent, timeSlotId: string, roleId: string) => {\n    e.preventDefault();\n    e.currentTarget.classList.remove(\"is-drag-over\");\n\n    const types = Array.from(e.dataTransfer.types);\n    console.log(\"[Drop] types:\", types);\n\n    // 内部のセル間移動（配置チップのドラッグ）\n    const internalStaffId = e.dataTransfer.getData(\"text/staff-id\");\n    const assignmentId = e.dataTransfer.getData(\"text/assignment-id\");\n\n    console.log(\"[Drop] internalStaffId:\", internalStaffId, \"assignmentId:\", assignmentId);\n\n    if (assignmentId && internalStaffId && onMoveAssignment) {\n      // 既存配置の移動\n      onMoveAssignment(assignmentId, internalStaffId, timeSlotId, roleId);\n      return;\n    }\n\n    if (internalStaffId && !assignmentId && onDropStaff) {\n      // ShiftPlanEditor内スタッフ一覧からの新規配置\n      console.log(\"[Drop] internal new assignment, staffId:\", internalStaffId);\n      onDropStaff(internalStaffId, timeSlotId, roleId);\n      return;\n    }\n\n    // ObjectViewからのドラッグ（独立バブルのスタッフ一覧からの新規配置）\n    const staffDragType = getDragType(\"Staff\");\n    if (types.includes(staffDragType)) {\n      // staffDragType自体にURLが設定されている\n      const url = e.dataTransfer.getData(staffDragType) || e.dataTransfer.getData(DRAG_KEYS.url);\n      console.log(\"[Drop] staffDragType found, url:\", url);\n      // URLからstaffIdを抽出: \"gakkai-shift/staffs/:id\"\n      const match = url.match(/gakkai-shift\\/staffs?\\/([^/]+)/);\n      console.log(\"[Drop] match:\", match);\n      if (match && onDropStaff) {\n        const staffId = match[1];\n        console.log(\"[Drop] calling onDropStaff with staffId:\", staffId);\n        onDropStaff(staffId, timeSlotId, roleId);\n      }\n    }\n  };\n\n  const handleChipDragStart = (e: React.DragEvent, assignmentId: string, staffId: string) => {\n    e.dataTransfer.setData(\"text/staff-id\", staffId);\n    e.dataTransfer.setData(\"text/assignment-id\", assignmentId);\n    e.dataTransfer.effectAllowed = \"move\";\n  };\n\n  // 日付でグループ化\n  const slotsByDate = timeSlots.reduce((acc, slot) => {\n    if (!acc[slot.date]) {\n      acc[slot.date] = [];\n    }\n    acc[slot.date].push(slot);\n    return acc;\n  }, {} as Record<string, TimeSlot_時間帯[]>);\n\n  const dates = Object.keys(slotsByDate).sort();\n\n  return (\n    <StyledTable>\n      <thead>\n        <tr>\n          <th className=\"e-date-header\">日付</th>\n          <th className=\"e-slot-header\">時間帯</th>\n          {roles.map((role) => (\n            <th key={role.id} className=\"e-role-header\">\n              <div className=\"e-role-name\">{role.name}</div>\n              <div className=\"e-role-fixedness\">\n                {Role_係.getFixednessLabel(role.fixedness)}\n              </div>\n            </th>\n          ))}\n        </tr>\n      </thead>\n      <tbody>\n        {dates.map((date) =>\n          slotsByDate[date].map((slot, slotIdx) => (\n            <tr key={slot.id}>\n              {slotIdx === 0 && (\n                <td rowSpan={slotsByDate[date].length} className=\"e-date-cell\">\n                  {formatDate(date)}\n                </td>\n              )}\n              <td className=\"e-slot-cell\">\n                <div className=\"e-slot-label\">{slot.label.split(\" \")[1]}</div>\n                <div className=\"e-slot-time\">\n                  {slot.state.startTime} - {slot.state.endTime}\n                </div>\n              </td>\n              {roles.map((role) => {\n                const cellAssignments = getAssignmentsForCell(slot.id, role.id);\n                const score = calculateCellScore(slot.id, role.id);\n                const requirement = slot.getRequirementForRole(role.id);\n                const requiredCount = requirement?.requiredCount ?? 0;\n                const assignedCount = cellAssignments.length;\n                const hasRequirement = requiredCount > 0;\n                const isFilled = assignedCount >= requiredCount;\n                const isShortage = hasRequirement && assignedCount < (requirement?.minCount ?? requiredCount);\n                const isExcess = hasRequirement && assignedCount > (requirement?.maxCount ?? requiredCount);\n\n                // 空き枠の数を計算\n                const emptySlotCount = Math.max(0, requiredCount - assignedCount);\n                const cellUrl = buildCellUrl?.(slot.id, role.id);\n\n                return (\n                  <td\n                    key={`${slot.id}_${role.id}`}\n                    className={`e-assignment-cell ${!hasRequirement ? \"no-requirement\" : \"\"}`}\n                    onDragOver={handleDragOver}\n                    onDragLeave={handleDragLeave}\n                    onDrop={(e) => handleDrop(e, slot.id, role.id)}\n                  >\n                    <div className=\"e-cell-content\">\n                      {hasRequirement && (\n                        <div className={`e-requirement ${isFilled ? \"is-filled\" : \"\"} ${isShortage ? \"is-shortage\" : \"\"} ${isExcess ? \"is-excess\" : \"\"}`}>\n                          {assignedCount}/{requiredCount}\n                        </div>\n                      )}\n                      {cellAssignments.map((assignment) => {\n                        const staff = getStaff(assignment.staffId);\n                        const isAvailable = staff?.isAvailableAt(slot.id) ?? false;\n                        const violation = getViolationForAssignment(assignment.id);\n                        const hasViolation = !!violation;\n                        const assignmentUrl = buildAssignmentUrl?.(assignment.id) ?? `gakkai-shift/assignments/${assignment.id}`;\n                        const staffName = getStaffName(assignment.staffId);\n                        return (\n                          <ObjectView\n                            key={assignment.id}\n                            type=\"ShiftAssignment\"\n                            url={assignmentUrl}\n                            label={staffName}\n                            draggable={false}\n                            onClick={() => onAssignmentClick?.(assignment.id)}\n                          >\n                            <div\n                              className={`e-staff-chip ${isAvailable ? \"is-available\" : \"is-unavailable\"} ${hasViolation ? \"has-violation\" : \"\"}`}\n                              draggable\n                              onDragStart={(e) => handleChipDragStart(e, assignment.id, assignment.staffId)}\n                            >\n                              {hasViolation && (\n                                <Tooltip title={violation.message} arrow>\n                                  <WarningIcon className=\"e-violation-icon\" fontSize=\"inherit\" />\n                                </Tooltip>\n                              )}\n                              <span className=\"e-staff-name\">\n                                <PersonIcon fontSize=\"inherit\" />\n                                {staffName}\n                              </span>\n                              <IconButton\n                                size=\"small\"\n                                className=\"e-remove-btn\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  onRemoveAssignment?.(assignment.id);\n                                }}\n                              >\n                                <CloseIcon fontSize=\"inherit\" />\n                              </IconButton>\n                            </div>\n                          </ObjectView>\n                        );\n                      })}\n                      {/* 空き枠のプレースホルダー（必ず1つ以上表示） */}\n                      {hasRequirement && (\n                        <div\n                          className={`e-empty-slot ${emptySlotCount === 0 ? \"is-full\" : \"\"}`}\n                          data-url={cellUrl}\n                          onClick={() => onCellClick?.(slot.id, role.id)}\n                        >\n                          <span className=\"e-empty-label\">\n                            {emptySlotCount > 0 ? `+ ${emptySlotCount}名追加` : \"+ 追加\"}\n                          </span>\n                        </div>\n                      )}\n                      {cellAssignments.length > 0 && (\n                        <div className={`e-score ${score >= 0 ? \"is-positive\" : \"is-negative\"}`}>\n                          {score > 0 ? \"+\" : \"\"}{score}pt\n                        </div>\n                      )}\n                    </div>\n                  </td>\n                );\n              })}\n            </tr>\n          ))\n        )}\n      </tbody>\n    </StyledTable>\n  );\n};\n\nconst formatDate = (dateStr: string): string => {\n  const date = new Date(dateStr);\n  const month = date.getMonth() + 1;\n  const day = date.getDate();\n  const weekdays = [\"日\", \"月\", \"火\", \"水\", \"木\", \"金\", \"土\"];\n  const weekday = weekdays[date.getDay()];\n  return `${month}/${day}(${weekday})`;\n};\n\nconst StyledTable = styled.table`\n  border-collapse: collapse;\n  font-size: 0.85em;\n  width: 100%;\n\n  th,\n  td {\n    border: 1px solid #ddd;\n    padding: 4px 6px;\n    vertical-align: top;\n  }\n\n  th {\n    background-color: #f5f5f5;\n    font-weight: bold;\n    text-align: center;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n  }\n\n  .e-date-header,\n  .e-slot-header {\n    width: 80px;\n    min-width: 80px;\n  }\n\n  .e-role-header {\n    min-width: 100px;\n\n    .e-role-name {\n      font-size: 0.9em;\n    }\n\n    .e-role-fixedness {\n      font-size: 0.7em;\n      color: #888;\n      font-weight: normal;\n    }\n  }\n\n  .e-date-cell {\n    font-weight: bold;\n    background-color: #fafafa;\n    text-align: center;\n    vertical-align: middle;\n  }\n\n  .e-slot-cell {\n    text-align: center;\n\n    .e-slot-label {\n      font-weight: bold;\n    }\n\n    .e-slot-time {\n      font-size: 0.8em;\n      color: #666;\n    }\n  }\n\n  .e-assignment-cell {\n    min-height: 60px;\n    transition: background-color 0.15s;\n\n    &.is-drag-over {\n      background-color: #e3f2fd;\n    }\n\n    &.no-requirement {\n      background-color: #fafafa;\n    }\n  }\n\n  .e-cell-content {\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n  }\n\n  .e-empty-slot {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 4px 8px;\n    border: 1px dashed #ccc;\n    border-radius: 4px;\n    background-color: #fafafa;\n    cursor: pointer;\n    transition: background-color 0.15s, border-color 0.15s;\n\n    &:hover {\n      background-color: #e3f2fd;\n      border-color: #1976d2;\n    }\n\n    .e-empty-label {\n      font-size: 0.8em;\n      color: #888;\n    }\n\n    &:hover .e-empty-label {\n      color: #1976d2;\n    }\n\n    &.is-full {\n      border-style: dotted;\n      background-color: transparent;\n      padding: 2px 6px;\n\n      .e-empty-label {\n        font-size: 0.7em;\n        color: #aaa;\n      }\n    }\n  }\n\n  .e-requirement {\n    font-size: 0.65em;\n    color: #999;\n    text-align: right;\n    font-weight: 500;\n    line-height: 1;\n\n    &.is-filled {\n      color: #4caf50;\n    }\n\n    &.is-shortage {\n      color: #f44336;\n      font-weight: bold;\n    }\n\n    &.is-excess {\n      color: #ff9800;\n    }\n  }\n\n  .e-staff-chip {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 2px 4px;\n    border-radius: 4px;\n    font-size: 0.85em;\n    cursor: grab;\n    transition: opacity 0.15s, box-shadow 0.15s;\n\n    &:active {\n      cursor: grabbing;\n    }\n\n    &[draggable=\"true\"]:hover {\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);\n    }\n\n    &.is-available {\n      background-color: #e8f5e9;\n      border: 1px solid #a5d6a7;\n    }\n\n    &.is-unavailable {\n      background-color: #ffebee;\n      border: 1px solid #ef9a9a;\n    }\n\n    &.has-violation {\n      border: 2px solid #ff9800;\n      background-color: #fff3e0;\n      animation: violation-pulse 1.5s ease-in-out infinite;\n    }\n\n    .e-violation-icon {\n      color: #ff9800;\n      margin-right: 2px;\n      font-size: 1em;\n    }\n\n    .e-staff-name {\n      display: flex;\n      align-items: center;\n      gap: 2px;\n    }\n\n    .e-remove-btn {\n      padding: 0;\n      font-size: 0.9em;\n    }\n  }\n\n  .e-score {\n    font-size: 0.75em;\n    text-align: right;\n    font-weight: bold;\n\n    &.is-positive {\n      color: #2e7d32;\n    }\n\n    &.is-negative {\n      color: #c62828;\n    }\n  }\n\n  @keyframes violation-pulse {\n    0%, 100% {\n      box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.4);\n    }\n    50% {\n      box-shadow: 0 0 0 4px rgba(255, 152, 0, 0.2);\n    }\n  }\n`;\n","'use client';\n\nimport { FC, useEffect, useMemo } from \"react\";\nimport styled from \"styled-components\";\nimport { useAppDispatch, useAppSelector } from \"@bublys-org/state-management\";\nimport {\n  selectGakkaiShiftStaffList,\n  selectGakkaiShiftPlanById,\n  addShiftPlan,\n  updateShiftPlan,\n  setStaffList,\n} from \"../slice/index.js\";\nimport { ShiftPlanTableView } from \"../ui/ShiftPlanTableView.js\";\nimport {\n  TimeSlot_時間帯,\n  Role_係,\n  ShiftPlan_シフト案,\n  ShiftAssignment_シフト配置,\n  ConstraintViolation,\n  ShiftMatcher_シフトマッチング,\n} from \"../domain/index.js\";\nimport { createSampleStaffList } from \"../data/sampleStaff.js\";\nimport WarningIcon from \"@mui/icons-material/Warning\";\nimport AutoFixHighIcon from \"@mui/icons-material/AutoFixHigh\";\nimport PeopleIcon from \"@mui/icons-material/People\";\nimport { Button } from \"@mui/material\";\nimport { UrledPlace } from \"@bublys-org/bubbles-ui\";\n\ntype ShiftPlanEditorProps = {\n  shiftPlanId: string;\n  onAssignmentClick?: (assignmentId: string) => void;\n  onCellClick?: (timeSlotId: string, roleId: string) => void;\n  onStaffViewClick?: () => void;\n  /** セルクリック時に開くバブルのURLを生成（origin-side配置用） */\n  buildCellUrl?: (timeSlotId: string, roleId: string) => string;\n};\n\nexport const ShiftPlanEditor: FC<ShiftPlanEditorProps> = ({\n  shiftPlanId,\n  onAssignmentClick,\n  onCellClick,\n  onStaffViewClick,\n  buildCellUrl,\n}) => {\n  const dispatch = useAppDispatch();\n  const staffList = useAppSelector(selectGakkaiShiftStaffList);\n  const shiftPlan = useAppSelector(selectGakkaiShiftPlanById(shiftPlanId));\n\n  // マスターデータ\n  const timeSlots = useMemo(() => TimeSlot_時間帯.createDefaultTimeSlots(), []);\n  const roles = useMemo(() => Role_係.createDefaultRoles(), []);\n\n  // 制約違反を取得（状態から）\n  const violations = useMemo<ReadonlyArray<ConstraintViolation>>(() => {\n    if (!shiftPlan) return [];\n    return shiftPlan.constraintViolations;\n  }, [shiftPlan]);\n\n  // 初期データのロード\n  useEffect(() => {\n    if (staffList.length === 0) {\n      const sampleData = createSampleStaffList();\n      dispatch(setStaffList(sampleData.map((s) => s.toJSON())));\n    }\n  }, [dispatch, staffList.length]);\n\n  // シフト案がなければ作成\n  useEffect(() => {\n    if (!shiftPlan) {\n      const newPlan = ShiftPlan_シフト案.create(\"シフト案1\");\n      // IDを指定して作成\n      const planWithId = {\n        ...newPlan.state,\n        id: shiftPlanId,\n      };\n      dispatch(addShiftPlan(planWithId));\n    }\n  }, [dispatch, shiftPlan, shiftPlanId]);\n\n  const handleDropStaff = (staffId: string, timeSlotId: string, roleId: string) => {\n    if (!shiftPlan) return;\n\n    // 既に同じスタッフが同じ時間帯・係に配置されていないかチェック\n    const existingAssignment = shiftPlan.assignments.find(\n      (a) =>\n        a.staffId === staffId &&\n        a.timeSlotId === timeSlotId &&\n        a.roleId === roleId\n    );\n    if (existingAssignment) return;\n\n    // ドメインオブジェクトで配置を追加\n    const assignment = ShiftAssignment_シフト配置.create(\n      staffId,\n      timeSlotId,\n      roleId,\n      false // 手動配置\n    );\n    const updatedPlan = shiftPlan.addAssignment(assignment);\n    dispatch(updateShiftPlan(updatedPlan.state));\n  };\n\n  const handleRemoveAssignment = (assignmentId: string) => {\n    if (!shiftPlan) return;\n\n    // ドメインオブジェクトで配置を削除\n    const updatedPlan = shiftPlan.removeAssignment(assignmentId);\n    dispatch(updateShiftPlan(updatedPlan.state));\n  };\n\n  const handleMoveAssignment = (assignmentId: string, staffId: string, timeSlotId: string, roleId: string) => {\n    if (!shiftPlan) return;\n\n    // 同じスタッフが同じ時間帯・係に既に配置されていないかチェック\n    const existingAssignment = shiftPlan.assignments.find(\n      (a) =>\n        a.staffId === staffId &&\n        a.timeSlotId === timeSlotId &&\n        a.roleId === roleId\n    );\n    if (existingAssignment) return;\n\n    // ドメインオブジェクトで配置を移動（削除→追加）\n    const planAfterRemove = shiftPlan.removeAssignment(assignmentId);\n    const assignment = ShiftAssignment_シフト配置.create(\n      staffId,\n      timeSlotId,\n      roleId,\n      false\n    );\n    const updatedPlan = planAfterRemove.addAssignment(assignment);\n    dispatch(updateShiftPlan(updatedPlan.state));\n  };\n\n  // 自動シフト配置\n  const handleAutoAssign = () => {\n    if (!shiftPlan) return;\n\n    // 自動マッチングを実行\n    const result = ShiftMatcher_シフトマッチング.autoAssign(\n      staffList,\n      roles,\n      timeSlots,\n      shiftPlan.state.assignments, // 既存配置を維持\n      { preserveExistingAssignments: true }\n    );\n\n    // 新しい配置をドメインオブジェクトで追加\n    const existingIds = new Set(shiftPlan.assignments.map((a) => a.id));\n    const newAssignments = result.assignments.filter(\n      (a) => !existingIds.has(a.id)\n    );\n\n    let updatedPlan = shiftPlan;\n    for (const assignmentState of newAssignments) {\n      const assignment = new ShiftAssignment_シフト配置(assignmentState);\n      updatedPlan = updatedPlan.addAssignment(assignment);\n    }\n\n    dispatch(updateShiftPlan(updatedPlan.state));\n    console.log(\"[AutoAssign] Result:\", result.stats);\n  };\n\n  if (!shiftPlan) {\n    return <div>読み込み中...</div>;\n  }\n\n  return (\n    <StyledContainer>\n      <div className=\"e-header\">\n        <h3>{shiftPlan.name}</h3>\n        <div className=\"e-stats\">\n          <Button\n            variant=\"contained\"\n            size=\"small\"\n            startIcon={<AutoFixHighIcon />}\n            onClick={handleAutoAssign}\n            sx={{ mr: 1 }}\n          >\n            自動シフト配置\n          </Button>\n          <UrledPlace url={`gakkai-shift/shift-plans/${shiftPlanId}/staff-view`}>\n            <Button\n              variant=\"outlined\"\n              size=\"small\"\n              startIcon={<PeopleIcon />}\n              onClick={onStaffViewClick}\n              sx={{ mr: 2 }}\n            >\n              スタッフ別表示\n            </Button>\n          </UrledPlace>\n          配置数: {shiftPlan.assignments.length}件\n          {violations.length > 0 && (\n            <span className=\"e-violation-warning\">\n              <WarningIcon fontSize=\"small\" />\n              制約違反: {violations.length}件\n            </span>\n          )}\n        </div>\n      </div>\n\n      <div className=\"e-main\">\n        {/* シフト表 */}\n        <div className=\"e-table-panel\">\n          <ShiftPlanTableView\n            timeSlots={timeSlots}\n            roles={roles}\n            assignments={shiftPlan.assignments}\n            staffList={staffList}\n            violations={violations}\n            buildAssignmentUrl={(assignmentId) => `gakkai-shift/shift-plans/${shiftPlanId}/assignments/${assignmentId}/evaluation`}\n            buildCellUrl={buildCellUrl}\n            onDropStaff={handleDropStaff}\n            onRemoveAssignment={handleRemoveAssignment}\n            onMoveAssignment={handleMoveAssignment}\n            onAssignmentClick={onAssignmentClick}\n            onCellClick={onCellClick}\n          />\n        </div>\n      </div>\n    </StyledContainer>\n  );\n};\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n\n  .e-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 8px 12px;\n    border-bottom: 1px solid #eee;\n    flex-shrink: 0;\n\n    h3 {\n      margin: 0;\n    }\n\n    .e-stats {\n      color: #666;\n      font-size: 0.9em;\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    }\n\n    .e-violation-warning {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n      color: #ff9800;\n      font-weight: bold;\n      background-color: #fff3e0;\n      padding: 2px 8px;\n      border-radius: 4px;\n      border: 1px solid #ff9800;\n    }\n  }\n\n  .e-main {\n    flex: 1;\n    overflow: hidden;\n  }\n\n  .e-table-panel {\n    height: 100%;\n    overflow: auto;\n    padding: 8px;\n  }\n`;\n","'use client';\n\nimport { FC, useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { useAppDispatch, useAppSelector } from \"@bublys-org/state-management\";\nimport {\n  selectGakkaiShiftPlans,\n  addShiftPlan,\n  deleteShiftPlan,\n  setStaffList,\n  selectGakkaiShiftStaffList,\n} from \"../slice/index.js\";\nimport { ShiftPlanEditor } from \"./ShiftPlanEditor.js\";\nimport { ShiftPlan_シフト案 } from \"../domain/index.js\";\nimport { createSampleStaffList } from \"../data/sampleStaff.js\";\nimport AddIcon from \"@mui/icons-material/Add\";\nimport DeleteIcon from \"@mui/icons-material/Delete\";\nimport ContentCopyIcon from \"@mui/icons-material/ContentCopy\";\nimport { IconButton, Tooltip } from \"@mui/material\";\n\ntype ShiftPlanManagerProps = {\n  onAssignmentClick?: (shiftPlanId: string, assignmentId: string) => void;\n  onCellClick?: (timeSlotId: string, roleId: string) => void;\n  /** セルクリック時に開くバブルのURLを生成（origin-side配置用） */\n  buildCellUrl?: (timeSlotId: string, roleId: string) => string;\n  /** スタッフ別表示ボタンクリック時のコールバック */\n  onStaffViewClick?: (shiftPlanId: string) => void;\n};\n\nexport const ShiftPlanManager: FC<ShiftPlanManagerProps> = ({\n  onAssignmentClick,\n  onCellClick,\n  buildCellUrl,\n  onStaffViewClick,\n}) => {\n  const dispatch = useAppDispatch();\n  const shiftPlans = useAppSelector(selectGakkaiShiftPlans);\n  const staffList = useAppSelector(selectGakkaiShiftStaffList);\n  const [selectedPlanId, setSelectedPlanId] = useState<string | null>(null);\n\n  // 初期データのロード\n  useEffect(() => {\n    if (staffList.length === 0) {\n      const sampleData = createSampleStaffList();\n      dispatch(setStaffList(sampleData.map((s) => s.toJSON())));\n    }\n  }, [dispatch, staffList.length]);\n\n  // 初期シフト案がなければ作成\n  useEffect(() => {\n    if (shiftPlans.length === 0) {\n      const newPlan = ShiftPlan_シフト案.create(\"シフト案1\");\n      dispatch(addShiftPlan(newPlan.state));\n      setSelectedPlanId(newPlan.id);\n    } else if (!selectedPlanId || !shiftPlans.find((p) => p.id === selectedPlanId)) {\n      setSelectedPlanId(shiftPlans[0].id);\n    }\n  }, [dispatch, shiftPlans, selectedPlanId]);\n\n  const handleAddPlan = () => {\n    const planNumber = shiftPlans.length + 1;\n    const newPlan = ShiftPlan_シフト案.create(`シフト案${planNumber}`);\n    dispatch(addShiftPlan(newPlan.state));\n    setSelectedPlanId(newPlan.id);\n  };\n\n  const handleCopyPlan = (planId: string) => {\n    const sourcePlan = shiftPlans.find((p) => p.id === planId);\n    if (!sourcePlan) return;\n\n    const newPlan = ShiftPlan_シフト案.create(`${sourcePlan.name}のコピー`);\n\n    // 配置をコピー\n    const copiedState = {\n      ...newPlan.state,\n      assignments: sourcePlan.state.assignments.map((a) => ({\n        ...a,\n        id: crypto.randomUUID(), // 新しいIDを割り当て\n      })),\n    };\n\n    dispatch(addShiftPlan(copiedState));\n    setSelectedPlanId(newPlan.id);\n  };\n\n  const handleDeletePlan = (planId: string) => {\n    // 最後の1つは削除不可\n    if (shiftPlans.length <= 1) return;\n\n    dispatch(deleteShiftPlan(planId));\n    // 削除したプランが選択中だった場合、先頭のプランを選択\n    if (selectedPlanId === planId) {\n      const remaining = shiftPlans.filter((p) => p.id !== planId);\n      setSelectedPlanId(remaining[0]?.id ?? null);\n    }\n  };\n\n  const selectedPlan = shiftPlans.find((p) => p.id === selectedPlanId);\n\n  return (\n    <StyledContainer>\n      {/* タブバー */}\n      <div className=\"e-tab-bar\">\n        <div className=\"e-tabs\">\n          {shiftPlans.map((plan) => (\n            <div\n              key={plan.id}\n              className={`e-tab ${plan.id === selectedPlanId ? \"is-selected\" : \"\"}`}\n              onClick={() => setSelectedPlanId(plan.id)}\n            >\n              <span className=\"e-tab-name\">{plan.name}</span>\n              <span className=\"e-tab-count\">{plan.assignments.length}件</span>\n              <Tooltip title=\"コピー\" arrow>\n                <IconButton\n                  size=\"small\"\n                  className=\"e-tab-action\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleCopyPlan(plan.id);\n                  }}\n                >\n                  <ContentCopyIcon fontSize=\"inherit\" />\n                </IconButton>\n              </Tooltip>\n              {shiftPlans.length > 1 && (\n                <Tooltip title=\"削除\" arrow>\n                  <IconButton\n                    size=\"small\"\n                    className=\"e-tab-action e-delete-action\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleDeletePlan(plan.id);\n                    }}\n                  >\n                    <DeleteIcon fontSize=\"inherit\" />\n                  </IconButton>\n                </Tooltip>\n              )}\n            </div>\n          ))}\n        </div>\n        <Tooltip title=\"新しいシフト案を追加\" arrow>\n          <IconButton\n            size=\"small\"\n            className=\"e-add-btn\"\n            onClick={handleAddPlan}\n          >\n            <AddIcon />\n          </IconButton>\n        </Tooltip>\n      </div>\n\n      {/* 選択中のシフト案 */}\n      <div className=\"e-content\">\n        {selectedPlan ? (\n          <ShiftPlanEditor\n            key={selectedPlan.id}\n            shiftPlanId={selectedPlan.id}\n            onAssignmentClick={(assignmentId) => onAssignmentClick?.(selectedPlan.id, assignmentId)}\n            onCellClick={onCellClick}\n            buildCellUrl={buildCellUrl}\n            onStaffViewClick={() => onStaffViewClick?.(selectedPlan.id)}\n          />\n        ) : (\n          <div className=\"e-empty\">シフト案を選択してください</div>\n        )}\n      </div>\n    </StyledContainer>\n  );\n};\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n\n  .e-tab-bar {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 4px 8px;\n    background-color: #f0f0f0;\n    border-bottom: 1px solid #ddd;\n    flex-shrink: 0;\n  }\n\n  .e-tabs {\n    display: flex;\n    gap: 4px;\n    flex: 1;\n    overflow-x: auto;\n  }\n\n  .e-tab {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 12px;\n    background-color: #e0e0e0;\n    border-radius: 4px 4px 0 0;\n    cursor: pointer;\n    transition: background-color 0.15s;\n    white-space: nowrap;\n\n    &:hover {\n      background-color: #d0d0d0;\n    }\n\n    &.is-selected {\n      background-color: #fff;\n      border: 1px solid #ddd;\n      border-bottom: 1px solid #fff;\n      margin-bottom: -1px;\n    }\n\n    .e-tab-name {\n      font-weight: bold;\n      font-size: 0.9em;\n    }\n\n    .e-tab-count {\n      font-size: 0.75em;\n      color: #666;\n      background-color: rgba(0, 0, 0, 0.1);\n      padding: 1px 6px;\n      border-radius: 10px;\n    }\n\n    .e-tab-action {\n      opacity: 0;\n      transition: opacity 0.15s;\n      padding: 2px;\n      font-size: 0.85em;\n    }\n\n    .e-delete-action {\n      color: #d32f2f;\n\n      &:hover {\n        background-color: rgba(211, 47, 47, 0.1);\n      }\n    }\n\n    &:hover .e-tab-action {\n      opacity: 1;\n    }\n  }\n\n  .e-add-btn {\n    background-color: #1976d2;\n    color: white;\n\n    &:hover {\n      background-color: #1565c0;\n    }\n  }\n\n  .e-content {\n    flex: 1;\n    overflow: hidden;\n  }\n\n  .e-empty {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    color: #666;\n  }\n`;\n","'use client';\n\nimport { FC } from \"react\";\nimport styled from \"styled-components\";\nimport {\n  StaffAssignmentEvaluation_スタッフ配置評価,\n  SkillMatchDetail,\n  ConstraintViolation,\n} from \"../domain/index.js\";\nimport CheckCircleIcon from \"@mui/icons-material/CheckCircle\";\nimport CancelIcon from \"@mui/icons-material/Cancel\";\nimport WarningIcon from \"@mui/icons-material/Warning\";\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\nimport PersonIcon from \"@mui/icons-material/Person\";\nimport { Button } from \"@mui/material\";\nimport { ObjectView } from \"@bublys-org/bubbles-ui\";\n\ntype AssignmentEvaluationViewProps = {\n  evaluation: StaffAssignmentEvaluation_スタッフ配置評価;\n  staffName: string;\n  timeSlotLabel: string;\n  roleName: string;\n  constraintViolations?: ConstraintViolation[];\n  staffDetailUrl?: string;\n  staffAvailabilityUrl?: string;\n  onStaffClick?: () => void;\n  onTimeSlotClick?: () => void;\n};\n\nexport const AssignmentEvaluationView: FC<AssignmentEvaluationViewProps> = ({\n  evaluation,\n  staffName,\n  timeSlotLabel,\n  roleName,\n  constraintViolations = [],\n  staffDetailUrl,\n  staffAvailabilityUrl,\n  onStaffClick,\n  onTimeSlotClick,\n}) => {\n  const status = evaluation.getOverallStatus();\n\n  return (\n    <StyledContainer>\n      <div className=\"e-header\">\n        <div className=\"e-assignment-visual\">\n          {/* 左側: 時間帯・係のセル */}\n          <div className=\"e-cell\">\n            <div className=\"e-cell-primary\">\n              {staffAvailabilityUrl ? (\n                <ObjectView\n                  type=\"StaffAvailability\"\n                  url={staffAvailabilityUrl}\n                  label={`${staffName}の参加可能時間帯`}\n                  draggable={true}\n                  onClick={onTimeSlotClick}\n                >\n                  <Button variant=\"text\" size=\"small\" component=\"span\" className=\"e-link-button\">\n                    {timeSlotLabel}\n                  </Button>\n                </ObjectView>\n              ) : (\n                <span>{timeSlotLabel}</span>\n              )}\n            </div>\n            <div className=\"e-cell-secondary\">{roleName}</div>\n          </div>\n\n          {/* 中央: 総合評価 + 矢印 */}\n          <div className=\"e-center\">\n            <div className={`e-score is-${status}`}>\n              {evaluation.totalScore > 0 ? \"+\" : \"\"}{evaluation.totalScore}pt\n            </div>\n            <ArrowBackIcon className=\"e-arrow\" />\n          </div>\n\n          {/* 右側: スタッフ */}\n          <div className=\"e-cell\">\n            <div className=\"e-cell-primary\">\n              <PersonIcon className=\"e-person-icon\" />\n              {staffDetailUrl ? (\n                <ObjectView\n                  type=\"Staff\"\n                  url={staffDetailUrl}\n                  label={staffName}\n                  draggable={true}\n                  onClick={onStaffClick}\n                >\n                  <Button variant=\"text\" size=\"small\" component=\"span\" className=\"e-link-button\">\n                    {staffName}\n                  </Button>\n                </ObjectView>\n              ) : (\n                <span>{staffName}</span>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"e-section\">\n        <div className=\"e-section-title\">スキルマッチング</div>\n        <div className=\"e-skill-table\">\n          <div className=\"e-skill-header\">\n            <span className=\"e-skill-name\">スキル</span>\n            <span className=\"e-skill-required\">要求</span>\n            <span className=\"e-skill-has\">本人</span>\n            <span className=\"e-skill-result\">評価</span>\n          </div>\n          {evaluation.skillMatches.map((match, idx) => (\n            <SkillMatchRow key={idx} match={match} />\n          ))}\n        </div>\n      </div>\n\n      <div className=\"e-section\">\n        <div className=\"e-section-title\">時間帯</div>\n        <div className=\"e-row\">\n          <span className=\"e-label\">参加可能:</span>\n          <EvalIcon ok={evaluation.isAvailable} />\n        </div>\n        <div className=\"e-row\">\n          <span className=\"e-label\">発表重複:</span>\n          <span className={evaluation.hasPresentationConflict ? \"is-bad\" : \"is-good\"}>\n            {evaluation.hasPresentationConflict ? \"あり\" : \"なし\"}\n          </span>\n        </div>\n      </div>\n\n      {constraintViolations.length > 0 && (\n        <div className=\"e-section e-constraint-violations\">\n          <div className=\"e-section-title\">\n            <WarningIcon fontSize=\"inherit\" /> 制約違反\n          </div>\n          <ul className=\"e-violation-list\">\n            {constraintViolations.map((violation, idx) => (\n              <li key={idx}>{violation.message}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {evaluation.issues.length > 0 && (\n        <div className=\"e-section e-issues\">\n          <div className=\"e-section-title\">\n            <WarningIcon fontSize=\"inherit\" /> 注意事項\n          </div>\n          <ul className=\"e-issue-list\">\n            {evaluation.issues.map((issue, idx) => (\n              <li key={idx}>{issue}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </StyledContainer>\n  );\n};\n\n// 評価アイコン\nconst EvalIcon: FC<{ ok: boolean }> = ({ ok }) => (\n  <span className={ok ? \"is-good\" : \"is-bad\"}>\n    {ok ? <CheckCircleIcon fontSize=\"inherit\" /> : <CancelIcon fontSize=\"inherit\" />}\n  </span>\n);\n\n// スキルレベルを日本語に変換\nconst getSkillLevelLabel = (level: string): string => {\n  const labels: Record<string, string> = {\n    none: 'なし',\n    beginner: '初級',\n    intermediate: '中級',\n    advanced: '上級',\n  };\n  return labels[level] ?? level;\n};\n\n// 係からの要求を日本語に変換\nconst getRequiredLabel = (required: string): string => {\n  if (required === 'none') return '要求なし';\n  if (required === 'any') return 'あれば優先';\n  return getSkillLevelLabel(required);\n};\n\nconst getScoreSymbol = (diff: number): string => {\n  if (diff >= 2) return '◎';\n  if (diff >= 1) return '○';\n  if (diff >= 0) return '△';\n  return '×';\n};\n\n// スキルマッチ行\nconst SkillMatchRow: FC<{ match: SkillMatchDetail }> = ({ match }) => {\n  // 要求なしの場合は評価対象外\n  const isNotRequired = match.required === 'none';\n\n  return (\n    <div className=\"e-skill-row\">\n      <span className=\"e-skill-name\">{match.skillName}</span>\n      <span className=\"e-skill-required\">{getRequiredLabel(match.required as string)}</span>\n      <span className=\"e-skill-has\">{getSkillLevelLabel(match.staffHas as string)}</span>\n      <span className={`e-skill-result ${isNotRequired ? \"is-not-required\" : match.isMatch ? \"is-match\" : \"is-no-match\"}`}>\n        {isNotRequired ? \"-\" : `${getScoreSymbol(match.scoreDiff)} ${match.scoreDiff > 0 ? `+${match.scoreDiff}` : match.scoreDiff}`}\n      </span>\n    </div>\n  );\n};\n\nconst StyledContainer = styled.div`\n  padding: 12px;\n  font-size: 0.9em;\n\n  .e-header {\n    margin-bottom: 12px;\n    padding-bottom: 12px;\n    border-bottom: 2px solid #1976d2;\n  }\n\n  .e-assignment-visual {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n\n  .e-cell {\n    flex: 1;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    padding: 6px 10px;\n    min-width: 0;\n  }\n\n  .e-cell-primary {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    font-weight: bold;\n    font-size: 0.85em;\n    white-space: nowrap;\n  }\n\n  .e-cell-secondary {\n    font-size: 0.75em;\n    color: #666;\n    margin-top: 2px;\n  }\n\n  .e-center {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    flex-shrink: 0;\n  }\n\n  .e-score {\n    font-size: 0.8em;\n    font-weight: bold;\n    margin-bottom: 2px;\n\n    &.is-excellent { color: #2e7d32; }\n    &.is-good { color: #558b2f; }\n    &.is-acceptable { color: #f9a825; }\n    &.is-warning { color: #ef6c00; }\n    &.is-error { color: #c62828; }\n  }\n\n  .e-arrow {\n    color: #999;\n  }\n\n  .e-person-icon {\n    font-size: 1.1em;\n    color: #666;\n  }\n\n  .e-section {\n    margin-bottom: 12px;\n    padding: 8px;\n    border: 1px solid #e0e0e0;\n    border-radius: 4px;\n\n    &.e-issues {\n      background-color: #fff3e0;\n      border-color: #ff9800;\n    }\n\n    &.e-constraint-violations {\n      background-color: #fffde7;\n      border-color: #fbc02d;\n    }\n  }\n\n  .e-violation-list {\n    margin: 0;\n    padding-left: 20px;\n\n    li {\n      padding: 2px 0;\n      color: #f57f17;\n    }\n  }\n\n  .e-section-title {\n    font-weight: bold;\n    font-size: 0.85em;\n    color: #666;\n    margin-bottom: 6px;\n    display: flex;\n    align-items: center;\n    gap: 4px;\n  }\n\n  .e-row {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 2px 0;\n\n    .e-label {\n      min-width: 80px;\n      color: #666;\n    }\n  }\n\n  .is-good {\n    color: #2e7d32;\n    display: flex;\n    align-items: center;\n    gap: 2px;\n  }\n\n  .is-bad {\n    color: #c62828;\n    display: flex;\n    align-items: center;\n    gap: 2px;\n  }\n\n  .is-neutral {\n    color: #666;\n  }\n\n  .e-skill-table {\n    font-size: 0.9em;\n  }\n\n  .e-skill-header,\n  .e-skill-row {\n    display: flex;\n    align-items: center;\n    padding: 4px 0;\n\n    .e-skill-name {\n      width: 60px;\n      flex-shrink: 0;\n    }\n\n    .e-skill-required {\n      width: 80px;\n      flex-shrink: 0;\n    }\n\n    .e-skill-has {\n      width: 60px;\n      flex-shrink: 0;\n    }\n\n    .e-skill-result {\n      flex: 1;\n      text-align: right;\n    }\n  }\n\n  .e-skill-header {\n    font-size: 0.8em;\n    color: #888;\n    border-bottom: 1px solid #e0e0e0;\n    margin-bottom: 2px;\n  }\n\n  .e-skill-row {\n    .e-skill-name {\n      font-weight: bold;\n    }\n\n    .e-skill-required {\n      color: #1976d2;\n    }\n\n    .e-skill-has {\n      color: #333;\n    }\n\n    .e-skill-result {\n      font-weight: bold;\n\n      &.is-match {\n        color: #2e7d32;\n      }\n\n      &.is-no-match {\n        color: #c62828;\n      }\n\n      &.is-not-required {\n        color: #999;\n        font-weight: normal;\n      }\n    }\n  }\n\n  .e-issue-list {\n    margin: 0;\n    padding-left: 20px;\n\n    li {\n      padding: 2px 0;\n      color: #e65100;\n    }\n  }\n\n  .e-link-button {\n    padding: 0 4px;\n    min-width: auto;\n    font-size: inherit;\n    font-weight: inherit;\n    text-transform: none;\n    vertical-align: baseline;\n  }\n`;\n","'use client';\n\nimport { FC, useMemo } from \"react\";\nimport { useAppSelector } from \"@bublys-org/state-management\";\nimport {\n  selectGakkaiShiftStaffList,\n  selectGakkaiShiftPlanById,\n} from \"../slice/index.js\";\nimport { AssignmentEvaluationView } from \"../ui/AssignmentEvaluationView.js\";\nimport {\n  TimeSlot_時間帯,\n  Role_係,\n  Staff_スタッフ,\n  ShiftAssignment_シフト配置,\n  StaffAssignmentEvaluation_スタッフ配置評価,\n  ConstraintViolation,\n} from \"../domain/index.js\";\n\ntype AssignmentEvaluationProps = {\n  shiftPlanId: string;\n  assignmentId: string;\n  onStaffClick?: (staffId: string) => void;\n  onTimeSlotClick?: (staffId: string) => void;\n  buildStaffDetailUrl?: (staffId: string) => string;\n  buildStaffAvailabilityUrl?: (staffId: string) => string;\n};\n\nexport const AssignmentEvaluation: FC<AssignmentEvaluationProps> = ({\n  shiftPlanId,\n  assignmentId,\n  onStaffClick,\n  onTimeSlotClick,\n  buildStaffDetailUrl,\n  buildStaffAvailabilityUrl,\n}) => {\n  const staffList = useAppSelector(selectGakkaiShiftStaffList);\n  const shiftPlan = useAppSelector(selectGakkaiShiftPlanById(shiftPlanId));\n\n  // マスターデータ\n  const timeSlots = useMemo(() => TimeSlot_時間帯.createDefaultTimeSlots(), []);\n  const roles = useMemo(() => Role_係.createDefaultRoles(), []);\n\n  // 配置を取得\n  const assignment = useMemo(() => {\n    if (!shiftPlan) return undefined;\n    const assignmentState = shiftPlan.state.assignments.find(\n      (a) => a.id === assignmentId\n    );\n    return assignmentState ? new ShiftAssignment_シフト配置(assignmentState) : undefined;\n  }, [shiftPlan, assignmentId]);\n\n  // 関連データを取得\n  const staff = useMemo<Staff_スタッフ | undefined>(() => {\n    if (!assignment) return undefined;\n    return staffList.find((s) => s.id === assignment.staffId);\n  }, [staffList, assignment]);\n\n  const timeSlot = useMemo<TimeSlot_時間帯 | undefined>(() => {\n    if (!assignment) return undefined;\n    return timeSlots.find((t) => t.id === assignment.timeSlotId);\n  }, [timeSlots, assignment]);\n\n  const role = useMemo<Role_係 | undefined>(() => {\n    if (!assignment) return undefined;\n    return roles.find((r) => r.id === assignment.roleId);\n  }, [roles, assignment]);\n\n  // 評価を計算\n  const evaluation = useMemo<StaffAssignmentEvaluation_スタッフ配置評価 | undefined>(() => {\n    if (!assignment || !staff || !role || !timeSlot) return undefined;\n    return StaffAssignmentEvaluation_スタッフ配置評価.evaluate(\n      assignment,\n      staff,\n      role,\n      timeSlot\n    );\n  }, [assignment, staff, role, timeSlot]);\n\n  // この配置に関連する制約違反を取得（状態から）\n  const constraintViolations = useMemo<ConstraintViolation[]>(() => {\n    if (!shiftPlan) return [];\n    return shiftPlan.constraintViolations.filter((v) => v.assignmentIds.includes(assignmentId));\n  }, [shiftPlan, assignmentId]);\n\n  if (!shiftPlan) {\n    return <div>シフト案が見つかりません</div>;\n  }\n\n  if (!assignment) {\n    return <div>配置が見つかりません</div>;\n  }\n\n  if (!staff || !role || !timeSlot || !evaluation) {\n    return <div>データを読み込み中...</div>;\n  }\n\n  return (\n    <AssignmentEvaluationView\n      evaluation={evaluation}\n      staffName={staff.name}\n      timeSlotLabel={timeSlot.label}\n      roleName={role.name}\n      constraintViolations={constraintViolations}\n      staffDetailUrl={buildStaffDetailUrl?.(staff.id)}\n      staffAvailabilityUrl={buildStaffAvailabilityUrl?.(staff.id)}\n      onStaffClick={() => onStaffClick?.(staff.id)}\n      onTimeSlotClick={() => onTimeSlotClick?.(staff.id)}\n    />\n  );\n};\n","'use client';\n\nimport { FC } from \"react\";\nimport styled from \"styled-components\";\nimport {\n  TimeSlot_時間帯,\n  Role_係,\n  Staff_スタッフ,\n  ShiftAssignment_シフト配置,\n  StaffAssignmentEvaluation_スタッフ配置評価,\n} from \"../domain/index.js\";\n\ntype StaffShiftTableViewProps = {\n  timeSlots: readonly TimeSlot_時間帯[];\n  roles: readonly Role_係[];\n  assignments: readonly ShiftAssignment_シフト配置[];\n  staffList: readonly Staff_スタッフ[];\n  onStaffClick?: (staffId: string) => void;\n  onAssignmentClick?: (assignmentId: string) => void;\n};\n\nexport const StaffShiftTableView: FC<StaffShiftTableViewProps> = ({\n  timeSlots,\n  roles,\n  assignments,\n  staffList,\n  onStaffClick,\n  onAssignmentClick,\n}) => {\n  // スタッフごとの配置を取得\n  const getAssignmentsForStaff = (staffId: string) => {\n    return assignments.filter((a) => a.staffId === staffId);\n  };\n\n  // 特定のスタッフ・時間帯の配置を取得\n  const getAssignmentForStaffAndTimeSlot = (staffId: string, timeSlotId: string) => {\n    return assignments.find(\n      (a) => a.staffId === staffId && a.timeSlotId === timeSlotId\n    );\n  };\n\n  // 評価スコアを計算\n  const calculateScore = (\n    staff: Staff_スタッフ,\n    assignment: ShiftAssignment_シフト配置\n  ): number => {\n    const role = roles.find((r) => r.id === assignment.roleId);\n    const timeSlot = timeSlots.find((t) => t.id === assignment.timeSlotId);\n    if (!role || !timeSlot) return 0;\n\n    const evaluation = StaffAssignmentEvaluation_スタッフ配置評価.evaluateCandidate(\n      staff,\n      role,\n      timeSlot\n    );\n    return evaluation.roleFitScore;\n  };\n\n  // 係名を取得\n  const getRoleName = (roleId: string): string => {\n    return roles.find((r) => r.id === roleId)?.name ?? \"不明\";\n  };\n\n  // 配置のあるスタッフのみ表示\n  const staffWithAssignments = staffList.filter(\n    (staff) => getAssignmentsForStaff(staff.id).length > 0\n  );\n\n  return (\n    <StyledTable>\n      <thead>\n        <tr>\n          <th className=\"e-staff-header\">スタッフ</th>\n          {timeSlots.map((slot) => (\n            <th key={slot.id} className=\"e-slot-header\">\n              {slot.label}\n            </th>\n          ))}\n          <th className=\"e-total-header\">配置数</th>\n        </tr>\n      </thead>\n      <tbody>\n        {staffWithAssignments.map((staff) => {\n          const staffAssignments = getAssignmentsForStaff(staff.id);\n          return (\n            <tr key={staff.id}>\n              <td\n                className=\"e-staff-cell\"\n                onClick={() => onStaffClick?.(staff.id)}\n              >\n                <div className=\"e-staff-name\">{staff.name}</div>\n                <div className=\"e-staff-school\">{staff.state.school}</div>\n              </td>\n              {timeSlots.map((slot) => {\n                const assignment = getAssignmentForStaffAndTimeSlot(staff.id, slot.id);\n                const isAvailable = staff.isAvailableAt(slot.id);\n\n                return (\n                  <td\n                    key={slot.id}\n                    className={`e-slot-cell ${isAvailable ? \"is-available\" : \"is-unavailable\"}`}\n                  >\n                    {!isAvailable && (\n                      <div className=\"e-unavailable-mark\">×</div>\n                    )}\n                    {assignment && (\n                      <div\n                        className={`e-assignment ${calculateScore(staff, assignment) >= 0 ? \"is-positive\" : \"is-negative\"}`}\n                        onClick={() => onAssignmentClick?.(assignment.id)}\n                      >\n                        <div className=\"e-role\">\n                          {getRoleName(assignment.roleId)}\n                        </div>\n                        <div className=\"e-score\">\n                          {calculateScore(staff, assignment) >= 0 ? \"+\" : \"\"}\n                          {calculateScore(staff, assignment)}\n                        </div>\n                      </div>\n                    )}\n                  </td>\n                );\n              })}\n              <td className=\"e-total-cell\">{staffAssignments.length}</td>\n            </tr>\n          );\n        })}\n      </tbody>\n    </StyledTable>\n  );\n};\n\nconst StyledTable = styled.table`\n  border-collapse: collapse;\n  font-size: 0.85em;\n  width: 100%;\n\n  th,\n  td {\n    border: 1px solid #ddd;\n    padding: 6px 8px;\n    vertical-align: middle;\n    text-align: center;\n  }\n\n  th {\n    background-color: #f5f5f5;\n    font-weight: bold;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n  }\n\n  .e-staff-header {\n    width: 120px;\n    min-width: 120px;\n    text-align: left;\n  }\n\n  .e-slot-header {\n    min-width: 80px;\n    font-size: 0.85em;\n  }\n\n  .e-total-header {\n    width: 60px;\n    min-width: 60px;\n  }\n\n  .e-staff-cell {\n    cursor: pointer;\n    transition: background-color 0.15s;\n    text-align: left;\n\n    &:hover {\n      background-color: #e3f2fd;\n    }\n\n    .e-staff-name {\n      font-weight: bold;\n    }\n\n    .e-staff-school {\n      font-size: 0.8em;\n      color: #666;\n    }\n  }\n\n  .e-slot-cell {\n    min-width: 80px;\n    position: relative;\n\n    &.is-unavailable {\n      background-color: #f5f5f5;\n    }\n  }\n\n  .e-unavailable-mark {\n    position: absolute;\n    top: 2px;\n    left: 4px;\n    font-size: 0.7em;\n    color: #999;\n  }\n\n  .e-assignment {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 2px;\n    padding: 4px 6px;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: opacity 0.15s;\n\n    &:hover {\n      opacity: 0.8;\n    }\n\n    &.is-positive {\n      background-color: #e8f5e9;\n      border: 1px solid #a5d6a7;\n    }\n\n    &.is-negative {\n      background-color: #ffebee;\n      border: 1px solid #ef9a9a;\n    }\n\n    .e-role {\n      font-weight: 500;\n      font-size: 0.9em;\n    }\n\n    .e-score {\n      font-size: 0.8em;\n      font-weight: bold;\n    }\n  }\n\n  .e-total-cell {\n    font-weight: bold;\n    background-color: #fafafa;\n  }\n`;\n","'use client';\n\nimport { FC, useEffect, useMemo } from \"react\";\nimport styled from \"styled-components\";\nimport { useAppDispatch, useAppSelector } from \"@bublys-org/state-management\";\nimport {\n  selectGakkaiShiftStaffList,\n  selectGakkaiShiftPlanById,\n  setStaffList,\n} from \"../slice/index.js\";\nimport { StaffShiftTableView } from \"../ui/StaffShiftTableView.js\";\nimport {\n  TimeSlot_時間帯,\n  Role_係,\n} from \"../domain/index.js\";\nimport { createSampleStaffList } from \"../data/sampleStaff.js\";\n\ntype StaffShiftTableProps = {\n  shiftPlanId: string;\n  onStaffClick?: (staffId: string) => void;\n  onAssignmentClick?: (shiftPlanId: string, assignmentId: string) => void;\n};\n\nexport const StaffShiftTable: FC<StaffShiftTableProps> = ({\n  shiftPlanId,\n  onStaffClick,\n  onAssignmentClick,\n}) => {\n  const dispatch = useAppDispatch();\n  const staffList = useAppSelector(selectGakkaiShiftStaffList);\n  const shiftPlan = useAppSelector(selectGakkaiShiftPlanById(shiftPlanId));\n\n  // マスターデータ\n  const timeSlots = useMemo(() => TimeSlot_時間帯.createDefaultTimeSlots(), []);\n  const roles = useMemo(() => Role_係.createDefaultRoles(), []);\n\n  // 初期データのロード\n  useEffect(() => {\n    if (staffList.length === 0) {\n      const sampleData = createSampleStaffList();\n      dispatch(setStaffList(sampleData.map((s) => s.toJSON())));\n    }\n  }, [dispatch, staffList.length]);\n\n  if (!shiftPlan) {\n    return <StyledContainer><div className=\"e-loading\">シフト案が見つかりません</div></StyledContainer>;\n  }\n\n  return (\n    <StyledContainer>\n      <div className=\"e-header\">\n        <h3>{shiftPlan.name} - スタッフ別シフト表</h3>\n        <div className=\"e-stats\">\n          配置数: {shiftPlan.assignments.length}件 /\n          スタッフ: {new Set(shiftPlan.assignments.map(a => a.staffId)).size}名\n        </div>\n      </div>\n\n      <div className=\"e-main\">\n        <StaffShiftTableView\n          timeSlots={timeSlots}\n          roles={roles}\n          assignments={shiftPlan.assignments}\n          staffList={staffList}\n          onStaffClick={onStaffClick}\n          onAssignmentClick={(assignmentId) => onAssignmentClick?.(shiftPlanId, assignmentId)}\n        />\n      </div>\n    </StyledContainer>\n  );\n};\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n\n  .e-loading {\n    padding: 20px;\n    text-align: center;\n    color: #666;\n  }\n\n  .e-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 8px 12px;\n    border-bottom: 1px solid #eee;\n    flex-shrink: 0;\n\n    h3 {\n      margin: 0;\n      font-size: 1em;\n    }\n\n    .e-stats {\n      color: #666;\n      font-size: 0.85em;\n    }\n  }\n\n  .e-main {\n    flex: 1;\n    overflow: auto;\n    padding: 8px;\n  }\n`;\n","\"use client\";\n\nimport { useContext } from \"react\";\nimport { BubbleRoute, BubblesContext } from \"@bublys-org/bubbles-ui\";\nimport { StaffCollection, parseStaffFilter, stringifyStaffFilter, StaffFilterCriteria as StaffFilterType } from \"../feature/StaffCollection.js\";\nimport { Role_係 } from \"../domain/index.js\";\nimport { StaffFilter } from \"../feature/StaffFilter.js\";\nimport { StaffDetail } from \"../feature/StaffDetail.js\";\nimport { StaffAvailability } from \"../feature/StaffAvailability.js\";\nimport { ShiftPlanEditor } from \"../feature/ShiftPlanEditor.js\";\nimport { ShiftPlanManager } from \"../feature/ShiftPlanManager.js\";\nimport { AssignmentEvaluation } from \"../feature/AssignmentEvaluation.js\";\nimport { StaffShiftTable } from \"../feature/StaffShiftTable.js\";\n\n// 学会シフト - スタッフ絞り込み検索バブル\nconst GakkaiShiftStaffFilterBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  // URLからクエリ文字列を抽出してフィルターをパース（既存の条件を復元）\n  const queryIndex = bubble.url.indexOf('?');\n  const query = queryIndex >= 0 ? bubble.url.slice(queryIndex + 1) : '';\n  const initialFilter = parseStaffFilter(query);\n\n  return <StaffFilter initialFilter={initialFilter} />;\n};\n\n// 学会シフト - スタッフ一覧バブル（フィルター付き）\nconst GakkaiShiftStaffsBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const { openBubble } = useContext(BubblesContext);\n  const handleStaffSelect = (staffId: string) => {\n    openBubble(`gakkai-shift/staffs/${staffId}`, bubble.id);\n  };\n\n  // URLからクエリ文字列を抽出してフィルターをパース\n  const queryIndex = bubble.url.indexOf('?');\n  const query = queryIndex >= 0 ? bubble.url.slice(queryIndex + 1) : '';\n  const filter = parseStaffFilter(query);\n\n  return <StaffCollection filter={filter} onStaffSelect={handleStaffSelect} />;\n};\n\n// 学会シフト - スタッフ詳細バブル\nconst GakkaiShiftStaffBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const staffId = bubble.url.replace(\"gakkai-shift/staffs/\", \"\");\n  const { openBubble } = useContext(BubblesContext);\n  const handleOpenAvailability = (staffId: string) => {\n    openBubble(`gakkai-shift/staffs/${staffId}/availableTimeSlots`, bubble.id);\n  };\n  return <StaffDetail staffId={staffId} onOpenAvailability={handleOpenAvailability} />;\n};\n\n// 学会シフト - スタッフ参加可能時間帯バブル\nconst GakkaiShiftStaffAvailabilityBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const staffId = bubble.url.replace(\"gakkai-shift/staffs/\", \"\").replace(\"/availableTimeSlots\", \"\");\n  return <StaffAvailability staffId={staffId} />;\n};\n\n// 学会シフト - シフト配置表バブル（単一シフト案）\nconst GakkaiShiftPlanEditorBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const { openBubble } = useContext(BubblesContext);\n  // URL: gakkai-shift/shift-plan/[shiftPlanId]\n  const shiftPlanId = bubble.url.replace(\"gakkai-shift/shift-plan/\", \"\");\n  const roles = Role_係.createDefaultRoles();\n\n  const handleAssignmentClick = (assignmentId: string) => {\n    openBubble(`gakkai-shift/shift-plans/${shiftPlanId}/assignments/${assignmentId}/evaluation`, bubble.id, \"origin-side\");\n  };\n\n  const handleStaffViewClick = () => {\n    openBubble(`gakkai-shift/shift-plans/${shiftPlanId}/staff-view`, bubble.id, \"origin-side\");\n  };\n\n  /** 係と時間帯からフィルターURLを構築（originCell付きで一意にする） */\n  const buildFilterUrl = (timeSlotId: string, roleId: string): string => {\n    const role = roles.find((r) => r.id === roleId);\n\n    const filter: StaffFilterType = {};\n    if (role) {\n      const requirements = role.requirements;\n      if (requirements.minPcSkill) {\n        filter.pc = { level: requirements.minPcSkill, operator: '>=' };\n      }\n      if (requirements.minZoomSkill) {\n        filter.zoom = { level: requirements.minZoomSkill, operator: '>=' };\n      }\n      if (requirements.requireEnglish) {\n        filter.english = true;\n      }\n      if (requirements.requireEventExperience) {\n        filter.eventExperience = true;\n      }\n    }\n    filter.availableAt = [timeSlotId];\n\n    const query = stringifyStaffFilter(filter);\n    // originCellを追加してURLを一意にする（getOriginRect用）\n    const originCell = `&originCell=${timeSlotId}_${roleId}`;\n    return `gakkai-shift/staffs${query}${originCell}`;\n  };\n\n  const handleCellClick = (timeSlotId: string, roleId: string) => {\n    const url = buildFilterUrl(timeSlotId, roleId);\n    openBubble(url, bubble.id, \"origin-side\");\n  };\n\n  return (\n    <ShiftPlanEditor\n      shiftPlanId={shiftPlanId}\n      onAssignmentClick={handleAssignmentClick}\n      onCellClick={handleCellClick}\n      onStaffViewClick={handleStaffViewClick}\n      buildCellUrl={buildFilterUrl}\n    />\n  );\n};\n\n// 学会シフト - シフト案マネージャー（複数シフト案）\nconst GakkaiShiftPlanManagerBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const { openBubble } = useContext(BubblesContext);\n  const roles = Role_係.createDefaultRoles();\n\n  const handleAssignmentClick = (shiftPlanId: string, assignmentId: string) => {\n    openBubble(`gakkai-shift/shift-plans/${shiftPlanId}/assignments/${assignmentId}/evaluation`, bubble.id, \"origin-side\");\n  };\n\n  const handleStaffViewClick = (shiftPlanId: string) => {\n    openBubble(`gakkai-shift/shift-plans/${shiftPlanId}/staff-view`, bubble.id, \"origin-side\");\n  };\n\n  /** 係と時間帯からフィルターURLを構築（originCell付きで一意にする） */\n  const buildFilterUrl = (timeSlotId: string, roleId: string): string => {\n    const role = roles.find((r) => r.id === roleId);\n\n    const filter: StaffFilterType = {};\n    if (role) {\n      const requirements = role.requirements;\n      if (requirements.minPcSkill) {\n        filter.pc = { level: requirements.minPcSkill, operator: '>=' };\n      }\n      if (requirements.minZoomSkill) {\n        filter.zoom = { level: requirements.minZoomSkill, operator: '>=' };\n      }\n      if (requirements.requireEnglish) {\n        filter.english = true;\n      }\n      if (requirements.requireEventExperience) {\n        filter.eventExperience = true;\n      }\n    }\n    filter.availableAt = [timeSlotId];\n\n    const query = stringifyStaffFilter(filter);\n    // originCellを追加してURLを一意にする（getOriginRect用）\n    const originCell = `&originCell=${timeSlotId}_${roleId}`;\n    return `gakkai-shift/staffs${query}${originCell}`;\n  };\n\n  const handleCellClick = (timeSlotId: string, roleId: string) => {\n    const url = buildFilterUrl(timeSlotId, roleId);\n    openBubble(url, bubble.id, \"origin-side\");\n  };\n\n  return (\n    <ShiftPlanManager\n      onAssignmentClick={handleAssignmentClick}\n      onCellClick={handleCellClick}\n      buildCellUrl={buildFilterUrl}\n      onStaffViewClick={handleStaffViewClick}\n    />\n  );\n};\n\n// 学会シフト - スタッフ別シフト表バブル\nconst GakkaiShiftStaffShiftTableBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const { openBubble } = useContext(BubblesContext);\n  // URL: gakkai-shift/shift-plans/[shiftPlanId]/staff-view\n  const match = bubble.url.match(/^gakkai-shift\\/shift-plans\\/([^/]+)\\/staff-view$/);\n  const shiftPlanId = match?.[1] ?? \"\";\n\n  const handleStaffClick = (staffId: string) => {\n    openBubble(`gakkai-shift/staffs/${staffId}`, bubble.id, \"bubble-side\");\n  };\n\n  const handleAssignmentClick = (shiftPlanId: string, assignmentId: string) => {\n    openBubble(`gakkai-shift/shift-plans/${shiftPlanId}/assignments/${assignmentId}/evaluation`, bubble.id, \"origin-side\");\n  };\n\n  return (\n    <StaffShiftTable\n      shiftPlanId={shiftPlanId}\n      onStaffClick={handleStaffClick}\n      onAssignmentClick={handleAssignmentClick}\n    />\n  );\n};\n\n// 学会シフト - 配置評価バブル\nconst GakkaiShiftAssignmentEvaluationBubble: BubbleRoute[\"Component\"] = ({ bubble }) => {\n  const { openBubble } = useContext(BubblesContext);\n  // URL: gakkai-shift/shift-plans/[shiftPlanId]/assignments/[assignmentId]/evaluation\n  const match = bubble.url.match(/^gakkai-shift\\/shift-plans\\/([^/]+)\\/assignments\\/([^/]+)\\/evaluation$/);\n  const shiftPlanId = match?.[1] ?? \"\";\n  const assignmentId = match?.[2] ?? \"\";\n\n  const handleStaffClick = (staffId: string) => {\n    openBubble(`gakkai-shift/staffs/${staffId}`, bubble.id, \"bubble-side\");\n  };\n\n  const handleTimeSlotClick = (staffId: string) => {\n    openBubble(`gakkai-shift/staffs/${staffId}/availableTimeSlots`, bubble.id, \"bubble-side\");\n  };\n\n  const buildStaffDetailUrl = (staffId: string) => `gakkai-shift/staffs/${staffId}`;\n  const buildStaffAvailabilityUrl = (staffId: string) => `gakkai-shift/staffs/${staffId}/availableTimeSlots`;\n\n  return (\n    <AssignmentEvaluation\n      shiftPlanId={shiftPlanId}\n      assignmentId={assignmentId}\n      onStaffClick={handleStaffClick}\n      onTimeSlotClick={handleTimeSlotClick}\n      buildStaffDetailUrl={buildStaffDetailUrl}\n      buildStaffAvailabilityUrl={buildStaffAvailabilityUrl}\n    />\n  );\n};\n\n/** 学会シフト機能のバブルルート定義 */\nexport const gakkaiShiftBubbleRoutes: BubbleRoute[] = [\n  { pattern: /^gakkai-shift\\/staffs\\/filter(\\?.*)?$/, type: \"gakkai-shift-staff-filter\", Component: GakkaiShiftStaffFilterBubble },\n  { pattern: /^gakkai-shift\\/staffs(\\?.*)?$/, type: \"gakkai-shift-staffs\", Component: GakkaiShiftStaffsBubble },\n  { pattern: /^gakkai-shift\\/staffs\\/[^/]+\\/availableTimeSlots$/, type: \"gakkai-shift-staff-availability\", Component: GakkaiShiftStaffAvailabilityBubble },\n  { pattern: /^gakkai-shift\\/staffs\\/[^/]+$/, type: \"gakkai-shift-staff\", Component: GakkaiShiftStaffBubble },\n  { pattern: /^gakkai-shift\\/shift-plans$/, type: \"gakkai-shift-plans\", Component: GakkaiShiftPlanManagerBubble },\n  { pattern: /^gakkai-shift\\/shift-plans\\/[^/]+\\/staff-view$/, type: \"gakkai-shift-staff-view\", Component: GakkaiShiftStaffShiftTableBubble },\n  { pattern: /^gakkai-shift\\/shift-plans\\/[^/]+\\/assignments\\/[^/]+\\/evaluation$/, type: \"gakkai-shift-assignment-evaluation\", Component: GakkaiShiftAssignmentEvaluationBubble },\n  { pattern: /^gakkai-shift\\/shift-plan\\/[^/]+$/, type: \"gakkai-shift-plan\", Component: GakkaiShiftPlanEditorBubble },\n];\n","/**\n * Bublys Bubly Entry Point for gakkai-shift\n *\n * このファイルはスタンドアロンバンドルとしてビルドされ、\n * 動的にロードされるバブリとして動作する\n */\n\nimport React from \"react\";\nimport type { BubbleRoute } from \"@bublys-org/bubbles-ui\";\nimport EventNoteIcon from \"@mui/icons-material/EventNote\";\n\n// Bubble Routes\nimport { gakkaiShiftBubbleRoutes } from \"./registration/index.js\";\n\n// バブリインターフェース\ntype BublyMenuItem = {\n  label: string;\n  url: string | (() => string);\n  icon: React.ReactNode;\n};\n\ntype Bubly = {\n  name: string;\n  version: string;\n  menuItems?: BublyMenuItem[];\n  register: (context: BublyContext) => void;\n  unregister?: () => void;\n};\n\ntype BublyContext = {\n  registerBubbleRoutes: (routes: BubbleRoute[]) => void;\n  injectSlice: (slice: unknown) => void;\n};\n\nconst GakkaiShiftBubly: Bubly = {\n  name: \"gakkai-shift\",\n  version: \"0.0.1\",\n\n  menuItems: [\n    {\n      label: \"スタッフ一覧\",\n      url: \"gakkai-shift/staffs\",\n      icon: React.createElement(EventNoteIcon, { color: \"action\" }),\n    },\n    {\n      label: \"シフト配置表\",\n      url: \"gakkai-shift/shift-plans\",\n      icon: React.createElement(EventNoteIcon, { color: \"primary\" }),\n    },\n  ],\n\n  register(context: BublyContext) {\n    console.log(\"[GakkaiShiftBubly] Registering...\");\n\n    // NOTE: Redux slicesはsliceファイルのimport時に自動注入される（injectIntoパターン）\n    // gakkai-shift-slice.ts と shift-plan-slice.ts が読み込まれた時点で注入済み\n    console.log(\"[GakkaiShiftBubly] Slices auto-injected: gakkaiShift, shiftPlan\");\n\n    // Bubble routesを登録\n    context.registerBubbleRoutes(gakkaiShiftBubbleRoutes);\n    console.log(\"[GakkaiShiftBubly] Registered\", gakkaiShiftBubbleRoutes.length, \"bubble routes\");\n\n    console.log(\"[GakkaiShiftBubly] Registration complete\");\n  },\n\n  unregister() {\n    console.log(\"[GakkaiShiftBubly] Unregistering...\");\n  },\n};\n\n// グローバルに登録\ndeclare global {\n  interface Window {\n    __BUBLYS_BUBLIES__?: Record<string, Bubly>;\n  }\n}\n\nwindow.__BUBLYS_BUBLIES__ = window.__BUBLYS_BUBLIES__ || {};\nwindow.__BUBLYS_BUBLIES__[\"gakkai-shift\"] = GakkaiShiftBubly;\n\nconsole.log(\"[GakkaiShiftBubly] Bubly loaded and registered to window.__BUBLYS_BUBLIES__\");\n\nexport default GakkaiShiftBubly;\n"],"names":["timeSlots","initialState","createSlice","rootReducer","createSelector","buildDetailUrl","ObjectView","styled","useAppDispatch","useAppSelector","useContext","BubblesContext","useEffect","useMemo","StyledContainer","Button","useState","formatDate","ToggleButtonGroup","ToggleButton","FormControlLabel","Checkbox","buildAvailabilityUrl","getDragType","DRAG_KEYS","StyledTable","Tooltip","IconButton","selectGakkaiShiftPlanById","UrledPlace","selectGakkaiShiftPlans","staffId","shiftPlanId","GakkaiShiftBubly","React"],"mappings":"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"}